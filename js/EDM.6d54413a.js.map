{"version":3,"sources":["webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./src/views/EDM/EDM.vue","webpack:///./src/components/EDMTemplateCard.vue","webpack:///./src/components/EDMTemplateCard.vue?8e5e","webpack:///./src/components/EDMTemplateCard.vue?4302","webpack:///./src/views/EDM/EDM.vue?a41e","webpack:///./src/views/EDM/EDM.vue?b23c","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./src/views/EDM/EDM.vue?0422","webpack:///./src/constants/edm-cover.ts","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js","webpack:///./src/components/EDMTemplateCard.vue?2d15"],"names":["userAgent","firefox","match","module","exports","id","class","onCreateClick","type","teamValue","placeholder","value","label","teamOptions","item","key","gutter","list","sort","a","b","span","editable","onCardClick","onDuplicateClick","onDeleteClick","cover_photo","src","formatImageUrl","file","alt","subject","visible","placement","offset","width","trigger","show-arrow","reference","icon","Component","name","props","Boolean","default","setup","_","emit","render","__scopeId","components","EDMTemplateCard","router","store","undefined","data","init","loadingInstance","teams","edms","map","it","checked","console","log","close","params","message","message_body","html_message","chosen_collection","dispatch","push","title","getCover","COVER_URL","$","aFunction","toObject","toLength","fails","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","test","nativeSort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","index","result","String","fromCharCode","k","v","length","charAt","FORCED","getSortCompare","comparefn","x","y","target","proto","forced","array","this","call","itemsLength","items","arrayLength","webkit","COVER1","COVER2","COVER3","templateId","floor","Math","mergeSort","middle","insertionSort","merge","slice","element","j","i","left","right","llength","rlength","lindex","rindex","UA"],"mappings":"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","file":"js/EDM.6d54413a.js","sourcesContent":["var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","<!--suppress ALL -->\n<template>\n  <div id=\"edm-component\">\n    <div class=\"top-container\">\n      <el-button @click=\"onCreateClick\" type=\"success\">Create EDM</el-button>\n      <div class=\"select-item\">\n        <label class=\"label\">Team</label>\n        <el-select v-model=\"teamValue\" placeholder=\"Select\">\n          <el-option :value=\"-1\" label=\"All\"> </el-option>\n          <el-option\n            v-for=\"item in teamOptions\"\n            :key=\"item.value\"\n            :value=\"item.value\"\n            :label=\"item.label\"\n          ></el-option>\n        </el-select>\n      </div>\n    </div>\n    <el-row :gutter=\"60\">\n      <el-col\n        v-for=\"item in list.sort((a, b) => b.id - a.id)\"\n        :key=\"item.id\"\n        :span=\"8\"\n      >\n        <EDMTemplateCard\n          editable\n          @click=\"onCardClick(item.id)\"\n          @duplicate=\"onDuplicateClick(item)\"\n          @delete=\"onDeleteClick(item)\"\n        >\n          <img\n            v-if=\"item.cover_photo\"\n            class=\"edm-cover-image\"\n            :src=\"formatImageUrl(item.cover_photo.file)\"\n            alt=\"cover\"\n          />\n          <p v-else>No Cover</p>\n        </EDMTemplateCard>\n        <p class=\"name\">{{ item.subject }}</p>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted, ref, watch } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n\nimport EDMTemplateCard from \"@/components/EDMTemplateCard.vue\";\nimport { COVER_URL, getCover } from \"@/constants/edm-cover\";\nimport { PostCreateEdm, PostDuplicateEdm } from \"@/typings/store\";\nimport { EdmCardResponse, EdmParams } from \"@/typings/edm\";\nimport { ElNotification } from \"element-plus\";\nimport { loading } from \"@/utils\";\nimport { getEdms, deleteEdm } from \"@/apis/edm\";\nimport { getCompanyTeams } from \"@/apis/company\";\nimport { OptionItem } from \"@/typings/asideFilter\";\nimport { MemberTeam } from \"@/typings/member\";\nimport { formatImageUrl } from \"@/utils/image\";\n\nconst Component = defineComponent({\n  name: \"EDM\",\n  components: {\n    EDMTemplateCard\n  },\n  setup: function() {\n    const router = useRouter();\n    const store = useStore();\n\n    const list = ref<EdmCardResponse[]>([]);\n    const teamValue = ref(-1);\n    const teamOptions = ref<OptionItem[]>([]);\n\n    watch([teamValue], async (value: number[]) => {\n      const id = value[0] > 0 ? value[0] : undefined;\n      const { data } = await getEdms(id);\n      list.value = data;\n    });\n\n    const init = async () => {\n      const loadingInstance = loading();\n      try {\n        const { data: teams } = await getCompanyTeams();\n        const { data: edms } = await getEdms();\n\n        teamOptions.value = teams.map(\n          (it: MemberTeam): OptionItem => ({\n            label: it.name,\n            value: it.id,\n            checked: false\n          })\n        );\n        list.value = edms;\n        console.log(edms);\n      } finally {\n        loadingInstance.close();\n      }\n    };\n\n    onMounted(init);\n\n    const onCreateClick = async () => {\n      const params: EdmParams = {\n        subject: `New EDM`,\n        message: \"Message\",\n        message_body: \"Text\",\n        html_message: \"<div></div>\",\n        chosen_collection: null\n      };\n      const { id } = await store.dispatch(PostCreateEdm, params);\n      await router.push({ name: \"EDMDetail\", params: { id } });\n    };\n\n    const onCardClick = async (id: number) => {\n      await router.push({ name: \"EDMDisplay\", params: { id } });\n    };\n\n    const onDuplicateClick = async (item: EdmCardResponse) => {\n      await store.dispatch(PostDuplicateEdm, item.id);\n      ElNotification({\n        title: \"Success\",\n        type: \"success\",\n        message: `EDM ${item.subject} duplicated successful.`\n      });\n      await init();\n    };\n\n    const onDeleteClick = async (item: EdmCardResponse) => {\n      const { data } = await deleteEdm(item.id);\n      ElNotification({\n        title: \"Success\",\n        type: \"success\",\n        message: data.message\n      });\n      await init();\n    };\n\n    return {\n      list,\n      teamValue,\n      teamOptions,\n\n      onCreateClick,\n      onCardClick,\n      onDuplicateClick,\n      onDeleteClick,\n      getCover,\n\n      formatImageUrl,\n      COVER_URL\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#edm-component\n  page-container()\n  padding-right 5px\n  padding-left 5px\n\n  .top-container\n    flex(space-between)\n    margin 0 0 30px\n    .el-button\n      width 180px\n      height 50px\n    .select-item\n      flex()\n      .label\n        margin-right 15px\n        font-size $font-size-lg3x\n        font-weight 500\n\n  .edm-cover-image\n      width 100%\n      height 100%\n\n    .name\n      text-align center\n      font-size $font-size-lg4x\n      font-weight 400\n      padding-top 15px\n\n  :deep() .el-col\n    margin-bottom 30px\n\n  :deep() .content-container\n    h1\n      font-size 10px\n      margin-bottom 6px\n    p\n      font-size 6px\n</style>\n","<template>\n  <div id=\"edm-template-card-component\">\n    <div class=\"wrapper\">\n      <slot></slot>\n\n      <el-popover\n        v-if=\"editable\"\n        v-model:visible=\"visible\"\n        placement=\"bottom\"\n        :offset=\"2\"\n        :width=\"80\"\n        trigger=\"click\"\n        :show-arrow=\"false\"\n      >\n        <div class=\"content\">\n          <p @click=\"onDuplicateClick\">Duplicate</p>\n          <p @click=\"onDeleteClick\">Delete</p>\n        </div>\n        <template #reference>\n          <div class=\"edit-icon\">\n            <font-awesome-icon\n              class=\"icon\"\n              :icon=\"['fas', 'ellipsis-h']\"\n            ></font-awesome-icon>\n          </div>\n        </template>\n      </el-popover>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref } from \"vue\";\n\nconst Component = defineComponent({\n  name: \"EDMTemplateCard\",\n  props: {\n    editable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(_, { emit }) {\n    const visible = ref(false);\n\n    const onDuplicateClick = () => {\n      visible.value = false;\n      emit(\"duplicate\");\n    };\n    const onDeleteClick = () => {\n      visible.value = false;\n      emit(\"delete\");\n    };\n\n    return {\n      visible,\n\n      onDuplicateClick,\n      onDeleteClick\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#edm-template-card-component\n  position relative\n  background-color white\n  width 100%\n  padding-bottom 70%\n  cursor pointer\n\n  &:hover\n    box-shadow: 0 4px 6px 0 rgba(0, 0, 0, 0.2), 0 6px 18px 0 rgba(0, 0, 0, 0.19);\n    .wrapper\n      .edit-icon\n        display flex\n\n  .wrapper\n    flex()\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 12px 0 rgba(0, 0, 0, 0.19);\n    position absolute\n    top 0\n    right 0\n    bottom 0\n    left 0\n\n    .edit-icon\n      flex()\n      display none\n      position absolute\n      bottom 10px\n      right 10px\n      width 35px\n      height 35px\n      background #4c4c4c\n      border-radius 5px\n      .icon\n        color white\n        width 25px\n        height 20px\n\n.content\n  padding 0 5px\n  p\n    padding 0\n    margin 10px 0\n    font-size 16px\n    font-weight 500\n    cursor pointer\n</style>\n","\nimport { defineComponent, ref } from \"vue\";\n\nconst Component = defineComponent({\n  name: \"EDMTemplateCard\",\n  props: {\n    editable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(_, { emit }) {\n    const visible = ref(false);\n\n    const onDuplicateClick = () => {\n      visible.value = false;\n      emit(\"duplicate\");\n    };\n    const onDeleteClick = () => {\n      visible.value = false;\n      emit(\"delete\");\n    };\n\n    return {\n      visible,\n\n      onDuplicateClick,\n      onDeleteClick\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./EDMTemplateCard.vue?vue&type=template&id=390a3655&scoped=true\"\nimport script from \"./EDMTemplateCard.vue?vue&type=script&lang=ts\"\nexport * from \"./EDMTemplateCard.vue?vue&type=script&lang=ts\"\n\nimport \"./EDMTemplateCard.vue?vue&type=style&index=0&id=390a3655&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-390a3655\"\n\nexport default script","\nimport { defineComponent, onMounted, ref, watch } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n\nimport EDMTemplateCard from \"@/components/EDMTemplateCard.vue\";\nimport { COVER_URL, getCover } from \"@/constants/edm-cover\";\nimport { PostCreateEdm, PostDuplicateEdm } from \"@/typings/store\";\nimport { EdmCardResponse, EdmParams } from \"@/typings/edm\";\nimport { ElNotification } from \"element-plus\";\nimport { loading } from \"@/utils\";\nimport { getEdms, deleteEdm } from \"@/apis/edm\";\nimport { getCompanyTeams } from \"@/apis/company\";\nimport { OptionItem } from \"@/typings/asideFilter\";\nimport { MemberTeam } from \"@/typings/member\";\nimport { formatImageUrl } from \"@/utils/image\";\n\nconst Component = defineComponent({\n  name: \"EDM\",\n  components: {\n    EDMTemplateCard\n  },\n  setup: function() {\n    const router = useRouter();\n    const store = useStore();\n\n    const list = ref<EdmCardResponse[]>([]);\n    const teamValue = ref(-1);\n    const teamOptions = ref<OptionItem[]>([]);\n\n    watch([teamValue], async (value: number[]) => {\n      const id = value[0] > 0 ? value[0] : undefined;\n      const { data } = await getEdms(id);\n      list.value = data;\n    });\n\n    const init = async () => {\n      const loadingInstance = loading();\n      try {\n        const { data: teams } = await getCompanyTeams();\n        const { data: edms } = await getEdms();\n\n        teamOptions.value = teams.map(\n          (it: MemberTeam): OptionItem => ({\n            label: it.name,\n            value: it.id,\n            checked: false\n          })\n        );\n        list.value = edms;\n        console.log(edms);\n      } finally {\n        loadingInstance.close();\n      }\n    };\n\n    onMounted(init);\n\n    const onCreateClick = async () => {\n      const params: EdmParams = {\n        subject: `New EDM`,\n        message: \"Message\",\n        message_body: \"Text\",\n        html_message: \"<div></div>\",\n        chosen_collection: null\n      };\n      const { id } = await store.dispatch(PostCreateEdm, params);\n      await router.push({ name: \"EDMDetail\", params: { id } });\n    };\n\n    const onCardClick = async (id: number) => {\n      await router.push({ name: \"EDMDisplay\", params: { id } });\n    };\n\n    const onDuplicateClick = async (item: EdmCardResponse) => {\n      await store.dispatch(PostDuplicateEdm, item.id);\n      ElNotification({\n        title: \"Success\",\n        type: \"success\",\n        message: `EDM ${item.subject} duplicated successful.`\n      });\n      await init();\n    };\n\n    const onDeleteClick = async (item: EdmCardResponse) => {\n      const { data } = await deleteEdm(item.id);\n      ElNotification({\n        title: \"Success\",\n        type: \"success\",\n        message: data.message\n      });\n      await init();\n    };\n\n    return {\n      list,\n      teamValue,\n      teamOptions,\n\n      onCreateClick,\n      onCardClick,\n      onDuplicateClick,\n      onDeleteClick,\n      getCover,\n\n      formatImageUrl,\n      COVER_URL\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./EDM.vue?vue&type=template&id=14d6e026&scoped=true\"\nimport script from \"./EDM.vue?vue&type=script&lang=ts\"\nexport * from \"./EDM.vue?vue&type=script&lang=ts\"\n\nimport \"./EDM.vue?vue&type=style&index=0&id=14d6e026&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-14d6e026\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar nativeSort = test.sort;\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return String(x) > String(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aFunction(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort.call(array) : nativeSort.call(array, comparefn);\n\n    var items = [];\n    var arrayLength = toLength(array.length);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) items.push(array[index]);\n    }\n\n    items = internalSort(items, getSortCompare(comparefn));\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EDM.vue?vue&type=style&index=0&id=14d6e026&scoped=true&lang=stylus\"","export const COVER_URL = {\n  COVER1: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_1.png\",\n  COVER2: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_2.png\",\n  COVER3: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_3.png\"\n};\n\nexport const getCover = (templateId: number) => {\n  if (templateId === 1) return COVER_URL.COVER1;\n  if (templateId === 2) return COVER_URL.COVER2;\n  if (templateId === 3) return COVER_URL.COVER3;\n  return COVER_URL.COVER1;\n};\n","// TODO: use something more complex like timsort?\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    mergeSort(array.slice(0, middle), comparefn),\n    mergeSort(array.slice(middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n  var result = [];\n\n  while (lindex < llength || rindex < rlength) {\n    if (lindex < llength && rindex < rlength) {\n      result.push(comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]);\n    } else {\n      result.push(lindex < llength ? left[lindex++] : right[rindex++]);\n    }\n  } return result;\n};\n\nmodule.exports = mergeSort;\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EDMTemplateCard.vue?vue&type=style&index=0&id=390a3655&scoped=true&lang=stylus\""],"sourceRoot":""}