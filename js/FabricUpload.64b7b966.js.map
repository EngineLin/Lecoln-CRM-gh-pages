{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./src/views/Fabric/FabricUpload.vue?2462","webpack:///./src/apis/member.ts","webpack:///./src/apis/project.ts","webpack:///./src/views/Fabric/FabricUpload.vue","webpack:///./src/views/Fabric/FabricUpload.vue?2fc2","webpack:///./src/views/Fabric/FabricUpload.vue?da11","webpack:///./src/utils/fabric.ts","webpack:///./src/assets/images/icons/png/upload.png"],"names":["redefine","anObject","fails","flags","TO_STRING","RegExpPrototype","RegExp","prototype","nativeToString","NOT_GENERIC","call","source","INCORRECT_NAME","name","R","this","p","String","rf","f","undefined","unsafe","getMembers","data","url","method","params","getMember","id","getMemberRoles","getMemberTeams","getMemberBusinessUnits","postMember","email","nickname","role","teams","phone","active","business_unit","postMemberPassword","postMemberAvatar","file","FormData","append","JSON","stringify","postContactUs","getAvaliableOptions","trialType","collectionId","fabricId","collection_id","fabric_id","getProjects","getProject","postCreateProject","payload","postCreateStage","formData","description","project","side","price","started_at","files","i","length","postUpdateStage","getProjectStage","postCreateDiscussion","message","toString","postDeleteDiscussion","postEditDiscussion","deleteDicussionFile","getProjectAvailableMember","q","getProjectJoinedMembers","postProjectJoinedMemberUpdate","joined_member","postProjectStatusUpdate","success","reason","postStageMediaCreate","stage","demo_fabric","getStagenames","companyId","getInform","postInform","subject","text","emails","recipients","putUploadProjectFabric","projectId","form","collection","start_fabric","start_fabric_image","end_fabric","end_fabric_image","postUploadProjectFabric","class","onPhotosUpload","src","iconUploadUrl","alt","photosBase64","base64","index","key","content","placement","effect","icon","onPhotoRemove","type","tg3d_fabric_id","video_urls","style","model-value","value","onVideoUrlChange","onVideoUrlAdd","sap_art_no","art_no","fetch-suggestions","onQuerySearch","toNameUpperCase","real_composition","onQuerySearchComposition","width","weight","status","statusOptions","item","label","disabled","exclusive_for","brandOptions","family_fabric_art_no","fabric_works_skus","tagType","options","tagTypeOptions","placeholder","fabricTypeValue","onQuerySearchFabricType","onSelectFabricType","tags","tag","closable","getTagType","parent_name","onTagClose","tag_name","onCancel","onSave","onUpload","checked","Component","setup","route","router","main_photo","photos","photos_with_id","storeMainPhoto","storePhotos","storePhotosWithId","fabricTypes","mainPhotoBase64","nameList","compositionList","timeId","sapArtNoInputStatus","artNoInputStatus","clearTimeout","setTimeout","valid","reader","FileReader","onload","e","target","result","readAsDataURL","concat","map","it","init","shadow","names","compositions","media","tag_parent","parent","reduce","createFilter","queryString","option","toLowerCase","indexOf","types","obj","forEach","cb","results","filter","onMainPhotoUpload","element","document","createElement","accept","addEventListener","click","some","multiple","ary","query","push","back","title","loadingInstance","fabricData","parseInt","close","getLastViewTimeString","render","__scopeId","splitRules","splitAry","split","letter","includes","_index","toUpperCase","join","removeEmptyChildren","children","findTagTypeItem","typeId","flatten","flattenList","find","module","exports"],"mappings":"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","file":"js/FabricUpload.64b7b966.js","sourcesContent":["'use strict';\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\nvar flags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar nativeToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = String(R.source);\n    var rf = R.flags;\n    var f = String(rf === undefined && R instanceof RegExp && !('flags' in RegExpPrototype) ? flags.call(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./FabricUpload.vue?vue&type=style&index=0&id=4b3f6934&scoped=true&lang=stylus\"","import request from \"@/apis/http\";\nimport { AxiosPromise } from \"axios\";\nimport { Member, MemberTeam, ContactUsParams, MemberRole, MembersParams } from \"@/typings/member\";\n\nexport function getMembers(data: MembersParams): AxiosPromise<Member[]> {\n  return request({\n    url: \"/members/\",\n    method: \"GET\",\n    params: data\n  });\n}\n\nexport function getMember(id?: number): AxiosPromise<Member> {\n  if (id) {\n    return request({\n      url: `/member/${id}/`,\n      method: \"GET\"\n    });\n  }\n  return request({\n    url: `/member/`,\n    method: \"GET\"\n  });\n}\n\nexport function getMemberRoles(id?: number, params?: { category?: string }): AxiosPromise<MemberRole[]> {\n  if (id) {\n    return request({\n      url: `/member/${id}/roles/`,\n      method: \"GET\",\n      params\n    });\n  }\n  return request({\n    url: `/member/roles/`,\n    method: \"GET\",\n    params\n  });\n}\n\n// Haven't id means get self teams data by token.\nexport function getMemberTeams(\n  id?: number,\n  params?: { category?: string }\n): AxiosPromise<MemberTeam[]> {\n  if (id) {\n    return request({\n      url: `/member/${id}/teams/`,\n      method: \"GET\",\n      params\n    });\n  }\n  return request({\n    url: \"/member/teams/\",\n    method: \"GET\",\n    params\n  });\n}\n\nexport function getMemberBusinessUnits(id?: number): AxiosPromise<string[]> {\n  if (id) {\n    return request({\n      url: `/member/${id}/business_units/`,\n      method: \"GET\"\n    });\n  }\n  return request({\n    url: \"/member/business_units/\",\n    method: \"GET\"\n  });\n}\n\nexport function postMember(params: Member, id?: number) {\n  const data = {\n    email: params.email,\n    nickname: params.nickname,\n    role: params.role,\n    teams: params.teams,\n    phone: params.phone,\n    active: params.active,\n    business_unit: params.business_unit\n  };\n  if (id) {\n    return request({\n      url: `/member/${id}/`,\n      method: \"PUT\",\n      data\n    });\n  }\n  return request({\n    url: `/member/`,\n    method: \"PUT\",\n    data\n  });\n}\n\nexport function postMemberPassword(data: { password: string }) {\n  return request({\n    url: `/member/`,\n    method: \"PUT\",\n    data\n  });\n}\n\nexport function postMemberAvatar(file: File, id?: number) {\n  const data = new FormData();\n  data.append(\"file\", file);\n  if (id) data.append(\"member\", JSON.stringify(id));\n\n  return request({\n    url: \"/member/medias/\",\n    method: \"POST\",\n    data\n  });\n}\n\nexport function postContactUs(data: ContactUsParams) {\n  return request({\n    url: `/mail/contact_us/`,\n    method: \"POST\",\n    data\n  });\n}\n","import request from \"@/apis/http\";\nimport {\n  DiscussionInput,\n  Project,\n  Projects,\n  ProjectCreateInputs,\n  StageCreateInputs,\n  ProjectsParams,\n  ProjectUpdateJoinedMemberParams,\n  StageMediaParams,\n  StageUpdate,\n  UploadProjectFabricParams,\n  ProjectFabricResponse\n} from \"@/typings/project\";\nimport { AxiosPromise } from \"axios\";\nimport { OptionParams } from \"@/typings/collection\";\n\nexport function getAvaliableOptions(\n  trialType: string,\n  collectionId?: number | null,\n  fabricId?: number | null\n) {\n  const params: { collection_id?: number; fabric_id?: number } = {};\n  if (collectionId) {\n    params.collection_id = collectionId;\n  }\n  if (fabricId) {\n    params.fabric_id = fabricId;\n  }\n  return request({\n    url: `/get_avaliable_brands/${trialType}`,\n    method: \"GET\",\n    params\n  });\n}\n\nexport function getProjects(params: ProjectsParams): AxiosPromise<Projects> {\n  return request({\n    url: `/projects/`,\n    method: \"GET\",\n    params\n  });\n}\n\nexport function getProject(id: number): AxiosPromise<Project> {\n  return request({\n    url: `/project/${id}/`,\n    method: \"GET\"\n  });\n}\n\nexport function postCreateProject(payload: ProjectCreateInputs) {\n  return request({\n    url: `/projects/`,\n    method: \"POST\",\n    data: payload\n  });\n}\n\nexport function postCreateStage(payload: StageCreateInputs) {\n  const formData = new FormData();\n  formData.append(\"name\", payload.name);\n  formData.append(\"description\", payload.description);\n  formData.append(\"project\", `${payload.project}`);\n  formData.append(\"side\", `${payload.side}`);\n  formData.append(\"price\", `${payload.price}`);\n  formData.append(\"started_at\", payload.started_at);\n  if (payload.files) {\n    for (let i = 0; i < payload.files.length; i++) {\n      formData.append(\"files\", payload.files[i]);\n    }\n  }\n  return request({\n    url: `/stages/`,\n    method: \"POST\",\n    data: formData\n  });\n}\n\nexport function postUpdateStage(payload: StageUpdate) {\n  return request({\n    url: `/stage/${payload.id}`,\n    method: \"PUT\",\n    data: {\n      name: payload.name,\n      price: payload.price,\n      description: payload.description\n    }\n  });\n}\n\nexport function getProjectStage(id: number) {\n  return request({\n    url: `/stage/${id}`,\n    method: \"GET\"\n  });\n}\n\nexport function postCreateDiscussion(payload: DiscussionInput) {\n  const formData = new FormData();\n  if (payload.files) {\n    for (let i = 0; i < payload.files.length; i++) {\n      formData.append(\"files\", payload.files[i]);\n    }\n  }\n  if (payload.message) formData.append(\"message\", payload.message);\n  if (payload.project) formData.append(\"project\", payload.project.toString());\n  return request({\n    url: `/discussions/`,\n    method: \"POST\",\n    data: formData\n  });\n}\n\nexport function postDeleteDiscussion(id: number) {\n  return request({\n    url: `/discussion/${id}`,\n    method: \"DELETE\"\n  });\n}\n\nexport function postEditDiscussion(id: number, message: string) {\n  const data = new FormData();\n  data.append(\"message\", message);\n\n  return request({\n    url: `/discussion/${id}`,\n    method: \"PUT\",\n    data\n  });\n}\n\nexport function deleteDicussionFile(id: number) {\n  return request({\n    url: `/attachment/${id}`,\n    method: \"DELETE\"\n  });\n}\n\nexport function getProjectAvailableMember(data: OptionParams) {\n  const params: { q?: string } = {};\n  if (data.q) params.q = data.q;\n\n  return request({\n    url: `/project/${data.id}/avaliable_memebr`,\n    method: \"GET\",\n    params\n  });\n}\n\nexport function getProjectJoinedMembers(id: number) {\n  return request({\n    url: `/project/${id}/joined_member`,\n    method: \"GET\"\n  });\n}\n\nexport function postProjectJoinedMemberUpdate({\n  id,\n  joined_member\n}: ProjectUpdateJoinedMemberParams) {\n  return request({\n    url: `/project/${id}/joined_member`,\n    method: \"PUT\",\n    data: { joined_member }\n  });\n}\n\nexport function postProjectStatusUpdate({\n  id,\n  success,\n  reason\n}: {\n  id: number;\n  success: boolean;\n  reason: string;\n}) {\n  return request({\n    url: `/project/${id}/status`,\n    method: \"PUT\",\n    data: { success, reason }\n  });\n}\n\nexport function postStageMediaCreate(data: StageMediaParams) {\n  const formData = new FormData();\n  formData.append(\"stage\", `${data.stage}`);\n  if (data.file) formData.append(\"file\", data.file);\n  if (data.demo_fabric) formData.append(\"demo_fabric\", `${data.demo_fabric}`);\n  return request({\n    url: `/stagemedias/`,\n    method: \"POST\",\n    data: formData\n  });\n}\n\nexport function getStagenames(id: number, companyId: number) {\n  return request({\n    url: `/project/${id}/stagename/${companyId}`,\n    method: \"GET\"\n  });\n}\n\nexport function getInform(id: number) {\n  return request({\n    url: `/project/${id}/inform/`,\n    method: \"GET\",\n  });\n}\n\nexport function postInform(id: number, subject: string, text: string, emails: string[]) {\n  const params = {\n    subject,\n    message: text,\n    recipients: emails\n  };\n  return request({\n    url: `/project/${id}/inform/`,\n    method: \"GET\",\n    params\n  });\n}\n\nexport function putUploadProjectFabric(projectId: number, data: UploadProjectFabricParams) {\n  if (!projectId) return;\n  const form = new FormData() ;\n  if (data.collection) form.append('collection', `${data.collection}`);\n  if (data.start_fabric) form.append('start_fabric', `${data.start_fabric}`);\n  if (data.start_fabric_image) form.append('start_fabric_image', `${data.start_fabric_image}`);\n  if (data.end_fabric) form.append('end_fabric', `${data.end_fabric}`);\n  if (data.end_fabric_image) form.append('end_fabric_image', `${data.end_fabric_image}`);\n\n  return request({\n    url: `/project/${projectId}/`,\n    method: 'PUT',\n    data: form\n  })\n}\n\nexport function postUploadProjectFabric(file: File): AxiosPromise<ProjectFabricResponse> {\n  const form = new FormData() ;\n  form.append('file', file);\n  return request({\n    url: `/simple_media/`,\n    method: 'POST',\n    data: form\n  })\n}\n","<template>\n  <div id=\"fabrics-upload-component\">\n    <div class=\"card\">\n      <div class=\"item\">\n        <p class=\"label\">Photos<span class=\"red-point\">*</span></p>\n        <div class=\"main-photo-container\">\n          <div class=\"note-container\">\n            <div class=\"note\">\n              <p>File Name: cloth number + _ + name</p>\n              <p>Photo within 1MB</p>\n              <p>1) Fabric picture: 10x10cm / 300dpi</p>\n              <p>2) Large image: 2000pixel / 300dpi</p>\n            </div>\n          </div>\n        </div>\n        <div class=\"photo-container\">\n          <div class=\"icon-upload\" @click=\"onPhotosUpload\">\n            <img :src=\"iconUploadUrl\" alt=\"upload\" />\n          </div>\n          <div class=\"photos\">\n            <div\n              v-for=\"(base64, index) in photosBase64\"\n              :key=\"index\"\n              class=\"photo\"\n            >\n              <el-tooltip :content=\"base64.name\" placement=\"top\" effect=\"light\">\n                <img :src=\"base64.src\" :alt=\"base64.name\" />\n              </el-tooltip>\n              <font-awesome-icon\n                class=\"icon\"\n                :icon=\"['fas', 'times-circle']\"\n                @click=\"onPhotoRemove(index)\"\n              ></font-awesome-icon>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">TG3D Fabric ID</p>\n        <el-input\n          class=\"value\"\n          type=\"text\"\n          v-model=\"form.tg3d_fabric_id\"\n        ></el-input>\n\n        <p class=\"label\">Video Url</p>\n        <el-input\n          v-for=\"(url, index) in form.video_urls\"\n          :key=\"index\"\n          class=\"value\"\n          :style=\"{ marginBottom: '8px' }\"\n          type=\"text\"\n          :model-value=\"url\"\n          @input=\"value => onVideoUrlChange(index, value)\"\n        ></el-input>\n\n        <div class=\"icon-add\" @click=\"onVideoUrlAdd\">\n          <font-awesome-icon\n            class=\"icon\"\n            :icon=\"['fas', 'plus-circle']\"\n          ></font-awesome-icon>\n        </div>\n      </div>\n      <div class=\"or-container\">\n        <div class=\"item\">\n          <p class=\"label\">New Art No in SAP (擇一)</p>\n          <el-input\n            class=\"value\"\n            :class=\"{\n              success: sapArtNoInputStatus === 1,\n              error: sapArtNoInputStatus === 2\n            }\"\n            type=\"text\"\n            v-model=\"form.sap_art_no\"\n          ></el-input>\n        </div>\n        <p class=\"or\">Or</p>\n        <div class=\"item\">\n          <p class=\"label\">Art No (擇一)</p>\n          <el-input\n            class=\"value\"\n            :class=\"{\n              success: artNoInputStatus === 1,\n              error: artNoInputStatus === 2\n            }\"\n            type=\"text\"\n            v-model=\"form.art_no\"\n          ></el-input>\n        </div>\n      </div>\n      <div class=\"line\"></div>\n      <div class=\"item\">\n        <p class=\"label\">Name<span class=\"red-point\">*</span></p>\n        <el-autocomplete\n          class=\"value\"\n          :model-value=\"form.name\"\n          :fetch-suggestions=\"onQuerySearch\"\n          @input=\"value => (form.name = toNameUpperCase(value))\"\n        ></el-autocomplete>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Real Composition<span class=\"red-point\">*</span></p>\n        <el-autocomplete\n          class=\"value\"\n          :model-value=\"form.real_composition\"\n          :fetch-suggestions=\"onQuerySearchComposition\"\n          @input=\"value => (form.real_composition = toNameUpperCase(value))\"\n        ></el-autocomplete>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Usable Width<span class=\"red-point\">*</span></p>\n        <div class=\"inch-item\">\n          <el-input class=\"value\" type=\"number\" v-model=\"form.width\"></el-input>\n          <p>Inch</p>\n        </div>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Weight in g/m²<span class=\"red-point\">*</span></p>\n        <el-input class=\"value\" type=\"number\" v-model=\"form.weight\"></el-input>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Status<span class=\"red-point\">*</span></p>\n        <el-select class=\"value\" v-model=\"form.status\">\n          <el-option\n            v-for=\"(item, index) in statusOptions\"\n            :key=\"index\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Limited Brand Name</p>\n        <el-select\n          :disabled=\"form.status !== 'exclusive'\"\n          class=\"value\"\n          v-model=\"form.exclusive_for\"\n        >\n          <el-option\n            v-for=\"(item, index) in brandOptions\"\n            :key=\"index\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">\n          Family Fabrics (art_no) (use \",\" to separate)\n        </p>\n        <el-input\n          class=\"value\"\n          type=\"text\"\n          v-model=\"form.family_fabric_art_no\"\n        ></el-input>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">\n          Fabric Works - SKU number (use \",\" to separate)\n        </p>\n        <el-input\n          class=\"value\"\n          type=\"text\"\n          v-model=\"form.fabric_works_skus\"\n        ></el-input>\n      </div>\n      <div class=\"line\"></div>\n      <div class=\"item\">\n        <p class=\"label\">Tags Selector</p>\n        <div class=\"tag-wrapper\">\n          <el-cascader\n            class=\"input\"\n            v-model=\"tagType\"\n            :options=\"tagTypeOptions\"\n            placeholder=\"Tag Type...\"\n          >\n          </el-cascader>\n        </div>\n        <el-autocomplete\n          class=\"input\"\n          v-model=\"fabricTypeValue\"\n          :fetch-suggestions=\"onQuerySearchFabricType\"\n          :disabled=\"!tagType.length\"\n          @keydown.enter=\"onSelectFabricType({ value: fabricTypeValue })\"\n          @select=\"onSelectFabricType\"\n        ></el-autocomplete>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Tags</p>\n        <div class=\"tag-wrapper\">\n          <el-tag\n            v-for=\"(tag, index) in form.tags\"\n            :key=\"index\"\n            class=\"tag\"\n            closable\n            :type=\"getTagType(tag.parent_name)\"\n            @close=\"onTagClose(tag)\"\n          >\n            {{ `${tag.parent_name}-${tag.tag_name}` }}\n          </el-tag>\n        </div>\n      </div>\n\n      <div class=\"footer-container\">\n        <el-button type=\"info\" @click=\"onCancel\">Cancel</el-button>\n        <el-button type=\"success\" @click=\"onSave\">Save</el-button>\n        <el-button type=\"success\" @click=\"onUpload\">Upload</el-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, reactive, onMounted, watch } from \"vue\";\nimport { getLastViewTimeString, loading } from \"@/utils\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport iconUploadUrl from \"@/assets/images/icons/png/upload.png\";\nimport {\n  checkArtNo,\n  getFabricCompositionList,\n  getFabricNameList,\n  getFabricShadow,\n  getFabricTagsType,\n  postFabricShadow,\n  postUploadFabric\n} from \"@/apis/fabric\";\nimport { CascaderOptionItem, OptionItem } from \"@/typings/asideFilter\";\nimport { getMemberTeams } from \"@/apis/member\";\nimport { getFabricTags } from \"@/apis/fabric\";\nimport { MemberTeam } from \"@/typings/member\";\nimport {\n  FabricFileResponse,\n  FabricTag,\n  FabricTagResponse,\n  FabricType,\n  PostUploadFabricParams\n} from \"@/typings/fabric\";\nimport { ElNotification } from \"element-plus\";\nimport {\n  findTagTypeItem,\n  removeEmptyChildren,\n  toNameUpperCase\n} from \"@/utils/fabric\";\nimport {\n  postProjectStatusUpdate,\n  putUploadProjectFabric\n} from \"@/apis/project\";\n\nconst statusOptions: OptionItem[] = [\n  { label: \"Public\", value: \"public\", checked: false },\n  { label: \"Private\", value: \"private\", checked: false },\n  { label: \"Exclusive - Brand\", value: \"exclusive\", checked: false }\n];\n\ninterface Base64 {\n  type: string;\n  name: string;\n  src: string;\n}\n\nconst Component = defineComponent({\n  name: \"FabricUpload\",\n  setup() {\n    const route = useRoute();\n    const router = useRouter();\n    const form = reactive<PostUploadFabricParams>({\n      main_photo: null,\n      photos: [],\n      photos_with_id: [],\n      video_urls: [],\n      tg3d_fabric_id: \"\",\n      sap_art_no: \"\",\n      art_no: \"\",\n      name: \"\",\n      real_composition: \"\",\n      width: 0,\n      weight: 0,\n      status: \"public\",\n      exclusive_for: null,\n      family_fabric_art_no: \"\",\n      fabric_works_skus: \"\",\n      tags: []\n    });\n    const storeMainPhoto = ref<File | null>(null);\n    const storePhotos = ref<File[]>([]);\n    const storePhotosWithId = ref<FabricFileResponse[]>([]);\n    const tagType = ref<number[]>([]);\n    const fabricTypeValue = ref(\"\");\n    const fabricTypes = ref<string[]>([]);\n\n    const mainPhotoBase64 = ref(\"\");\n    const photosBase64 = ref<Base64[]>([]);\n    const nameList = ref<string[]>([]);\n    const compositionList = ref<string[]>([]);\n    const brandOptions = ref<OptionItem[]>([]);\n    const tagTypeOptions = ref<CascaderOptionItem[]>([]);\n    const timeId = ref<ReturnType<typeof setTimeout> | undefined>(undefined);\n    const sapArtNoInputStatus = ref(0);\n    const artNoInputStatus = ref(0);\n\n    watch(\n      () => form.sap_art_no,\n      () => {\n        timeId.value && clearTimeout(timeId.value);\n        timeId.value = setTimeout(async () => {\n          if (!form.sap_art_no) {\n            sapArtNoInputStatus.value = 0;\n            return;\n          }\n          const { data } = await checkArtNo({ sap_art_no: form.sap_art_no });\n          sapArtNoInputStatus.value = data.valid ? 1 : 2;\n        }, 500);\n      }\n    );\n\n    watch(\n      () => form.art_no,\n      () => {\n        timeId.value && clearTimeout(timeId.value);\n        timeId.value = setTimeout(async () => {\n          if (!form.art_no) {\n            artNoInputStatus.value = 0;\n            return;\n          }\n          const { data } = await checkArtNo({ art_no: form.art_no });\n          artNoInputStatus.value = data.valid ? 1 : 2;\n        }, 500);\n      }\n    );\n\n    watch([storeMainPhoto], () => {\n      form.main_photo = storeMainPhoto.value;\n      if (!storeMainPhoto.value) return;\n      const reader = new FileReader();\n      reader.onload = function(e: any) {\n        mainPhotoBase64.value = e.target.result;\n      };\n      reader.readAsDataURL(storeMainPhoto.value);\n    });\n\n    watch([storePhotos], () => {\n      form.photos = storePhotos.value;\n      if (!storePhotos.value.length) return;\n      for (let i = 0; i < storePhotos.value.length; i++) {\n        const reader = new FileReader();\n        reader.onload = function(e: any) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo\",\n            name: storePhotos.value[i].name,\n            src: e.target.result\n          });\n        };\n        reader.readAsDataURL(storePhotos.value[i]);\n      }\n    });\n\n    watch([storePhotosWithId], () => {\n      form.photos_with_id = storePhotosWithId.value;\n      if (!storePhotosWithId.value.length) return;\n      for (let i = 0; i < storePhotosWithId.value.length; i++) {\n        photosBase64.value = photosBase64.value.concat({\n          type: \"photo_with_id\",\n          name: storePhotosWithId.value[i].name,\n          src: storePhotosWithId.value[i].file\n        });\n      }\n    });\n\n    watch([tagType], async () => {\n      if (tagType.value.length) {\n        const { data } = await getFabricTags(\n          tagType.value[tagType.value.length - 1]\n        );\n        fabricTypes.value = data.map((it: FabricType) => it.name);\n      }\n    });\n\n    const init = async () => {\n      const { data: shadow } = await getFabricShadow();\n      const { data: names } = await getFabricNameList();\n      const { data: compositions } = await getFabricCompositionList();\n      const { data: teams } = await getMemberTeams();\n      const { data: tags } = await getFabricTagsType();\n      storePhotosWithId.value = shadow.media;\n      form.video_urls = shadow.video_urls;\n      form.sap_art_no = shadow.sap_art_no;\n      form.art_no = shadow.art_no;\n      form.name = shadow.name;\n      form.real_composition = shadow.real_composition;\n      form.width = shadow.width;\n      form.weight = shadow.weight;\n      form.status = shadow.status;\n      form.exclusive_for = shadow.exclusive_for;\n      form.family_fabric_art_no = shadow.family_fabric_art_no;\n      form.fabric_works_skus = shadow.fabric_works_skus;\n      form.tg3d_fabric_id = shadow.tg3d_fabric_id;\n      form.tags = shadow.tags.map((it: FabricTagResponse) => ({\n        tag_parent: it.parent,\n        tag_name: it.name,\n        parent_name: it.parent_name\n      }));\n      nameList.value = names.names.map((it: string[]) => it[0]);\n      compositionList.value = compositions.real_composition.map(\n        (it: string[]) => it[0]\n      );\n      brandOptions.value = teams.map((it: MemberTeam) => ({\n        label: it.name,\n        value: it.id,\n        checked: false\n      }));\n      tagTypeOptions.value = tags.reduce(removeEmptyChildren, []);\n    };\n\n    onMounted(init);\n\n    const createFilter = (queryString: string) => {\n      return (option: string) => {\n        return option.toLowerCase().indexOf(queryString.toLowerCase()) > -1;\n      };\n    };\n\n    const getTagType = (type: string) => {\n      const types = [\"primary\", \"success\", \"info\", \"warning\", \"danger\"];\n      const obj = {};\n      tagTypeOptions.value.forEach((it: CascaderOptionItem, index: number) => {\n        // @ts-ignore\n        obj[it.label] = types[index % 5];\n      });\n      // @ts-ignore\n      return obj[type];\n    };\n\n    const onQuerySearch = async (queryString: string, cb: Function) => {\n      const results = queryString\n        ? nameList.value.filter(createFilter(queryString))\n        : nameList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchComposition = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? compositionList.value.filter(createFilter(queryString))\n        : compositionList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchFabricType = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? fabricTypes.value.filter(createFilter(queryString))\n        : fabricTypes.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onMainPhotoUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          storeMainPhoto.value = element.files[0];\n        }\n      });\n      element.click();\n    };\n\n    const onSelectFabricType = (data: { value: string }) => {\n      if (!data.value) return;\n\n      const target = findTagTypeItem(tagType.value, tagTypeOptions.value);\n      if (!target) return;\n      if (\n        form.tags &&\n        form.tags.some(\n          (it: FabricTag) =>\n            it.tag_name === data.value && it.tag_parent === target.value\n        )\n      ) {\n        fabricTypeValue.value = \"\";\n        return;\n      }\n\n      form.tags = [\n        ...form.tags!,\n        {\n          parent_name: target.label,\n          tag_name: data.value,\n          tag_parent: target.value\n        }\n      ];\n      fabricTypeValue.value = \"\";\n    };\n\n    const onTagClose = (data: FabricTag) => {\n      form.tags = form.tags.filter(\n        (it: FabricTag) =>\n          it.tag_name !== data.tag_name || it.tag_parent !== data.tag_parent\n      );\n    };\n\n    const onPhotosUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.multiple = true;\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          let ary: File[] = [];\n          for (let i = 0; i < element.files.length; i++) {\n            ary = [...ary, element.files[i]];\n          }\n          // @ts-ignore\n          storePhotos.value = ary;\n        }\n      });\n      element.click();\n    };\n\n    const onPhotoRemove = (index: number) => {\n      const target: Base64 = photosBase64.value[index];\n      photosBase64.value = [];\n\n      if (target.type === \"photo\") {\n        storePhotos.value = storePhotos.value.filter(\n          (it: File) => it.name !== target.name\n        );\n        if (!storePhotosWithId.value.length) return;\n        for (let i = 0; i < storePhotosWithId.value.length; i++) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo_with_id\",\n            name: storePhotosWithId.value[i].name,\n            src: storePhotosWithId.value[i].file\n          });\n        }\n      }\n      if (target.type === \"photo_with_id\") {\n        storePhotosWithId.value = storePhotosWithId.value.filter(\n          (it: FabricFileResponse) => it.name !== target.name\n        );\n        if (!storePhotos.value.length) return;\n        for (let i = 0; i < storePhotos.value.length; i++) {\n          const reader = new FileReader();\n          reader.onload = function(e: any) {\n            photosBase64.value = photosBase64.value.concat({\n              type: \"photo\",\n              name: storePhotos.value[i].name,\n              src: e.target.result\n            });\n          };\n          reader.readAsDataURL(storePhotos.value[i]);\n        }\n      }\n    };\n\n    const onVideoUrlAdd = () => {\n      if (!form.video_urls) return;\n      form.video_urls = [...form.video_urls, \"\"];\n    };\n\n    const onVideoUrlChange = (index: number, value: string) => {\n      // @ts-ignore\n      form.video_urls[index] = value;\n    };\n\n    const onCancel = async () => {\n      const { id: projectId } = route.query;\n      if (projectId) {\n        await router.push({\n          name: \"ProjectDetail\",\n          params: { id: projectId as string }\n        });\n      } else {\n        await router.back();\n      }\n    };\n\n    const onSave = async () => {\n      await postFabricShadow(form);\n      ElNotification({\n        type: \"success\",\n        title: \"Save\",\n        message: \"Save Fabric successfully\"\n      });\n\n      const { id: projectId } = route.query;\n      if (projectId) {\n        await router.push({\n          name: \"ProjectDetail\",\n          params: { id: projectId as string }\n        });\n      }\n    };\n\n    const onUpload = async () => {\n      const loadingInstance = loading();\n      try {\n        const { data: fabricData } = await postUploadFabric(form);\n\n        const { id: projectId } = route.query;\n        if (projectId) {\n          try {\n            await putUploadProjectFabric(parseInt(projectId as string, 10), {\n              end_fabric: fabricData.id\n            });\n            const { data: project } = await postProjectStatusUpdate({\n              id: parseInt(projectId as string, 10),\n              success: true,\n              reason: \"\"\n            });\n            ElNotification({\n              title: \"Success\",\n              type: \"success\",\n              message: `Change status to ${project.status}.`\n            });\n          } finally {\n            await router.push({\n              name: \"ProjectDetail\",\n              params: { id: projectId as string }\n            });\n          }\n\n        } else {\n          await router.push({\n            name: \"FabricDetail\",\n            params: { id: fabricData.id }\n          });\n        }\n      } finally {\n        loadingInstance.close();\n      }\n    };\n\n    return {\n      form,\n      mainPhotoBase64,\n      photosBase64,\n      tagType,\n      fabricTypeValue,\n      statusOptions,\n      brandOptions,\n      tagTypeOptions,\n      sapArtNoInputStatus,\n      artNoInputStatus,\n\n      onQuerySearch,\n      onQuerySearchComposition,\n      onQuerySearchFabricType,\n      onSelectFabricType,\n      onTagClose,\n      onMainPhotoUpload,\n      onPhotosUpload,\n      onPhotoRemove,\n      onVideoUrlAdd,\n      onVideoUrlChange,\n      onCancel,\n      onSave,\n      onUpload,\n\n      getTagType,\n      getLastViewTimeString,\n      toNameUpperCase,\n      iconUploadUrl\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#fabrics-upload-component\n  page-container()\n  .card\n    border-radius 15px\n    background white\n    padding 30px\n    flex-wrap wrap\n    flex(flex-start, flex-start)\n\n    .red-point\n      color red\n      margin 0 8px\n\n    .line\n      width 100%\n      height 2px\n      margin 15px 20px\n      background $color-secondary\n\n    .or-container\n      width 100%\n      flex()\n      .item\n        width calc(50% - 15px)\n      .or\n        padding-top 30px\n    .item\n      width calc(50% - 30px)\n      margin 0 15px 15px\n\n      :deep() .el-select\n        width 100%\n      :deep() .el-autocomplete\n        width calc(100% - 16px)\n        padding 0 8px\n\n      .label\n        padding 15px 8px 8px\n        font-size $font-size-large\n\n      .value\n        box-sizing border-box\n        width 100%\n        border-radius 4px\n        background white\n        padding 0 8px\n        font-size $font-size-lg2x\n        font-weight 400\n\n        &:focus\n          outline unset\n\n      .success\n        :deep() .el-input__inner\n          border 2px solid $color-active\n\n      .error\n        position relative\n        :deep() .el-input__inner\n          border 2px solid red\n        &:before\n          color red\n          font-size $font-size-small\n          content 'This Art No already exist.'\n          position absolute\n          bottom -80%\n          left 2%\n\n      .inch-item\n        flex()\n        margin 0 15px 0 0\n\n    .main-photo-container\n      flex(flex-start, flex-start)\n      .note-container\n        flex()\n        width calc(100% - 152px)\n        .note\n          font-size $font-size-normal\n          line-height 1.5\n    .photo-container\n      flex(flex-start)\n      margin 30px 0 0\n      .icon-upload\n        flex()\n        width 50px\n        height 50px\n        cursor pointer\n        margin 0 15px 0 0\n        img\n          width 30px\n          height 30px\n      .photos\n        flex(flex-start)\n        flex-wrap wrap\n        .photo\n          position relative\n          width 48px\n          height 48px\n          margin 0 8px 8px 0\n          border 1px solid black\n          background-repeat no-repeat\n          background-position center\n          background-size cover\n          img\n            width 100%\n            height 100%\n          .icon\n            position absolute\n            right -9px\n            top -9px\n            width 18px\n            height 18px\n            background white\n            cursor pointer\n    .icon-add\n      flex()\n      width 50px\n      height 50px\n      cursor pointer\n      .icon\n        width 30px\n        height 30px\n\n    .tag-wrapper\n      box-sizing border-box\n      padding 5px 8px\n      width 100%\n      font-size $font-size-lg2x\n      font-weight 400\n      border-radius 10px\n      background white\n\n      :deep() .el-cascader\n        width 100%\n      :deep() .el-autocomplete\n        width 100%\n      .tag\n        margin 0 8px 8px 0\n  .footer-container\n    width 100%\n    margin 30px 0 0\n    flex(flex-end)\n</style>\n","\nimport { defineComponent, ref, reactive, onMounted, watch } from \"vue\";\nimport { getLastViewTimeString, loading } from \"@/utils\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport iconUploadUrl from \"@/assets/images/icons/png/upload.png\";\nimport {\n  checkArtNo,\n  getFabricCompositionList,\n  getFabricNameList,\n  getFabricShadow,\n  getFabricTagsType,\n  postFabricShadow,\n  postUploadFabric\n} from \"@/apis/fabric\";\nimport { CascaderOptionItem, OptionItem } from \"@/typings/asideFilter\";\nimport { getMemberTeams } from \"@/apis/member\";\nimport { getFabricTags } from \"@/apis/fabric\";\nimport { MemberTeam } from \"@/typings/member\";\nimport {\n  FabricFileResponse,\n  FabricTag,\n  FabricTagResponse,\n  FabricType,\n  PostUploadFabricParams\n} from \"@/typings/fabric\";\nimport { ElNotification } from \"element-plus\";\nimport {\n  findTagTypeItem,\n  removeEmptyChildren,\n  toNameUpperCase\n} from \"@/utils/fabric\";\nimport {\n  postProjectStatusUpdate,\n  putUploadProjectFabric\n} from \"@/apis/project\";\n\nconst statusOptions: OptionItem[] = [\n  { label: \"Public\", value: \"public\", checked: false },\n  { label: \"Private\", value: \"private\", checked: false },\n  { label: \"Exclusive - Brand\", value: \"exclusive\", checked: false }\n];\n\ninterface Base64 {\n  type: string;\n  name: string;\n  src: string;\n}\n\nconst Component = defineComponent({\n  name: \"FabricUpload\",\n  setup() {\n    const route = useRoute();\n    const router = useRouter();\n    const form = reactive<PostUploadFabricParams>({\n      main_photo: null,\n      photos: [],\n      photos_with_id: [],\n      video_urls: [],\n      tg3d_fabric_id: \"\",\n      sap_art_no: \"\",\n      art_no: \"\",\n      name: \"\",\n      real_composition: \"\",\n      width: 0,\n      weight: 0,\n      status: \"public\",\n      exclusive_for: null,\n      family_fabric_art_no: \"\",\n      fabric_works_skus: \"\",\n      tags: []\n    });\n    const storeMainPhoto = ref<File | null>(null);\n    const storePhotos = ref<File[]>([]);\n    const storePhotosWithId = ref<FabricFileResponse[]>([]);\n    const tagType = ref<number[]>([]);\n    const fabricTypeValue = ref(\"\");\n    const fabricTypes = ref<string[]>([]);\n\n    const mainPhotoBase64 = ref(\"\");\n    const photosBase64 = ref<Base64[]>([]);\n    const nameList = ref<string[]>([]);\n    const compositionList = ref<string[]>([]);\n    const brandOptions = ref<OptionItem[]>([]);\n    const tagTypeOptions = ref<CascaderOptionItem[]>([]);\n    const timeId = ref<ReturnType<typeof setTimeout> | undefined>(undefined);\n    const sapArtNoInputStatus = ref(0);\n    const artNoInputStatus = ref(0);\n\n    watch(\n      () => form.sap_art_no,\n      () => {\n        timeId.value && clearTimeout(timeId.value);\n        timeId.value = setTimeout(async () => {\n          if (!form.sap_art_no) {\n            sapArtNoInputStatus.value = 0;\n            return;\n          }\n          const { data } = await checkArtNo({ sap_art_no: form.sap_art_no });\n          sapArtNoInputStatus.value = data.valid ? 1 : 2;\n        }, 500);\n      }\n    );\n\n    watch(\n      () => form.art_no,\n      () => {\n        timeId.value && clearTimeout(timeId.value);\n        timeId.value = setTimeout(async () => {\n          if (!form.art_no) {\n            artNoInputStatus.value = 0;\n            return;\n          }\n          const { data } = await checkArtNo({ art_no: form.art_no });\n          artNoInputStatus.value = data.valid ? 1 : 2;\n        }, 500);\n      }\n    );\n\n    watch([storeMainPhoto], () => {\n      form.main_photo = storeMainPhoto.value;\n      if (!storeMainPhoto.value) return;\n      const reader = new FileReader();\n      reader.onload = function(e: any) {\n        mainPhotoBase64.value = e.target.result;\n      };\n      reader.readAsDataURL(storeMainPhoto.value);\n    });\n\n    watch([storePhotos], () => {\n      form.photos = storePhotos.value;\n      if (!storePhotos.value.length) return;\n      for (let i = 0; i < storePhotos.value.length; i++) {\n        const reader = new FileReader();\n        reader.onload = function(e: any) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo\",\n            name: storePhotos.value[i].name,\n            src: e.target.result\n          });\n        };\n        reader.readAsDataURL(storePhotos.value[i]);\n      }\n    });\n\n    watch([storePhotosWithId], () => {\n      form.photos_with_id = storePhotosWithId.value;\n      if (!storePhotosWithId.value.length) return;\n      for (let i = 0; i < storePhotosWithId.value.length; i++) {\n        photosBase64.value = photosBase64.value.concat({\n          type: \"photo_with_id\",\n          name: storePhotosWithId.value[i].name,\n          src: storePhotosWithId.value[i].file\n        });\n      }\n    });\n\n    watch([tagType], async () => {\n      if (tagType.value.length) {\n        const { data } = await getFabricTags(\n          tagType.value[tagType.value.length - 1]\n        );\n        fabricTypes.value = data.map((it: FabricType) => it.name);\n      }\n    });\n\n    const init = async () => {\n      const { data: shadow } = await getFabricShadow();\n      const { data: names } = await getFabricNameList();\n      const { data: compositions } = await getFabricCompositionList();\n      const { data: teams } = await getMemberTeams();\n      const { data: tags } = await getFabricTagsType();\n      storePhotosWithId.value = shadow.media;\n      form.video_urls = shadow.video_urls;\n      form.sap_art_no = shadow.sap_art_no;\n      form.art_no = shadow.art_no;\n      form.name = shadow.name;\n      form.real_composition = shadow.real_composition;\n      form.width = shadow.width;\n      form.weight = shadow.weight;\n      form.status = shadow.status;\n      form.exclusive_for = shadow.exclusive_for;\n      form.family_fabric_art_no = shadow.family_fabric_art_no;\n      form.fabric_works_skus = shadow.fabric_works_skus;\n      form.tg3d_fabric_id = shadow.tg3d_fabric_id;\n      form.tags = shadow.tags.map((it: FabricTagResponse) => ({\n        tag_parent: it.parent,\n        tag_name: it.name,\n        parent_name: it.parent_name\n      }));\n      nameList.value = names.names.map((it: string[]) => it[0]);\n      compositionList.value = compositions.real_composition.map(\n        (it: string[]) => it[0]\n      );\n      brandOptions.value = teams.map((it: MemberTeam) => ({\n        label: it.name,\n        value: it.id,\n        checked: false\n      }));\n      tagTypeOptions.value = tags.reduce(removeEmptyChildren, []);\n    };\n\n    onMounted(init);\n\n    const createFilter = (queryString: string) => {\n      return (option: string) => {\n        return option.toLowerCase().indexOf(queryString.toLowerCase()) > -1;\n      };\n    };\n\n    const getTagType = (type: string) => {\n      const types = [\"primary\", \"success\", \"info\", \"warning\", \"danger\"];\n      const obj = {};\n      tagTypeOptions.value.forEach((it: CascaderOptionItem, index: number) => {\n        // @ts-ignore\n        obj[it.label] = types[index % 5];\n      });\n      // @ts-ignore\n      return obj[type];\n    };\n\n    const onQuerySearch = async (queryString: string, cb: Function) => {\n      const results = queryString\n        ? nameList.value.filter(createFilter(queryString))\n        : nameList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchComposition = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? compositionList.value.filter(createFilter(queryString))\n        : compositionList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchFabricType = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? fabricTypes.value.filter(createFilter(queryString))\n        : fabricTypes.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onMainPhotoUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          storeMainPhoto.value = element.files[0];\n        }\n      });\n      element.click();\n    };\n\n    const onSelectFabricType = (data: { value: string }) => {\n      if (!data.value) return;\n\n      const target = findTagTypeItem(tagType.value, tagTypeOptions.value);\n      if (!target) return;\n      if (\n        form.tags &&\n        form.tags.some(\n          (it: FabricTag) =>\n            it.tag_name === data.value && it.tag_parent === target.value\n        )\n      ) {\n        fabricTypeValue.value = \"\";\n        return;\n      }\n\n      form.tags = [\n        ...form.tags!,\n        {\n          parent_name: target.label,\n          tag_name: data.value,\n          tag_parent: target.value\n        }\n      ];\n      fabricTypeValue.value = \"\";\n    };\n\n    const onTagClose = (data: FabricTag) => {\n      form.tags = form.tags.filter(\n        (it: FabricTag) =>\n          it.tag_name !== data.tag_name || it.tag_parent !== data.tag_parent\n      );\n    };\n\n    const onPhotosUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.multiple = true;\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          let ary: File[] = [];\n          for (let i = 0; i < element.files.length; i++) {\n            ary = [...ary, element.files[i]];\n          }\n          // @ts-ignore\n          storePhotos.value = ary;\n        }\n      });\n      element.click();\n    };\n\n    const onPhotoRemove = (index: number) => {\n      const target: Base64 = photosBase64.value[index];\n      photosBase64.value = [];\n\n      if (target.type === \"photo\") {\n        storePhotos.value = storePhotos.value.filter(\n          (it: File) => it.name !== target.name\n        );\n        if (!storePhotosWithId.value.length) return;\n        for (let i = 0; i < storePhotosWithId.value.length; i++) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo_with_id\",\n            name: storePhotosWithId.value[i].name,\n            src: storePhotosWithId.value[i].file\n          });\n        }\n      }\n      if (target.type === \"photo_with_id\") {\n        storePhotosWithId.value = storePhotosWithId.value.filter(\n          (it: FabricFileResponse) => it.name !== target.name\n        );\n        if (!storePhotos.value.length) return;\n        for (let i = 0; i < storePhotos.value.length; i++) {\n          const reader = new FileReader();\n          reader.onload = function(e: any) {\n            photosBase64.value = photosBase64.value.concat({\n              type: \"photo\",\n              name: storePhotos.value[i].name,\n              src: e.target.result\n            });\n          };\n          reader.readAsDataURL(storePhotos.value[i]);\n        }\n      }\n    };\n\n    const onVideoUrlAdd = () => {\n      if (!form.video_urls) return;\n      form.video_urls = [...form.video_urls, \"\"];\n    };\n\n    const onVideoUrlChange = (index: number, value: string) => {\n      // @ts-ignore\n      form.video_urls[index] = value;\n    };\n\n    const onCancel = async () => {\n      const { id: projectId } = route.query;\n      if (projectId) {\n        await router.push({\n          name: \"ProjectDetail\",\n          params: { id: projectId as string }\n        });\n      } else {\n        await router.back();\n      }\n    };\n\n    const onSave = async () => {\n      await postFabricShadow(form);\n      ElNotification({\n        type: \"success\",\n        title: \"Save\",\n        message: \"Save Fabric successfully\"\n      });\n\n      const { id: projectId } = route.query;\n      if (projectId) {\n        await router.push({\n          name: \"ProjectDetail\",\n          params: { id: projectId as string }\n        });\n      }\n    };\n\n    const onUpload = async () => {\n      const loadingInstance = loading();\n      try {\n        const { data: fabricData } = await postUploadFabric(form);\n\n        const { id: projectId } = route.query;\n        if (projectId) {\n          try {\n            await putUploadProjectFabric(parseInt(projectId as string, 10), {\n              end_fabric: fabricData.id\n            });\n            const { data: project } = await postProjectStatusUpdate({\n              id: parseInt(projectId as string, 10),\n              success: true,\n              reason: \"\"\n            });\n            ElNotification({\n              title: \"Success\",\n              type: \"success\",\n              message: `Change status to ${project.status}.`\n            });\n          } finally {\n            await router.push({\n              name: \"ProjectDetail\",\n              params: { id: projectId as string }\n            });\n          }\n\n        } else {\n          await router.push({\n            name: \"FabricDetail\",\n            params: { id: fabricData.id }\n          });\n        }\n      } finally {\n        loadingInstance.close();\n      }\n    };\n\n    return {\n      form,\n      mainPhotoBase64,\n      photosBase64,\n      tagType,\n      fabricTypeValue,\n      statusOptions,\n      brandOptions,\n      tagTypeOptions,\n      sapArtNoInputStatus,\n      artNoInputStatus,\n\n      onQuerySearch,\n      onQuerySearchComposition,\n      onQuerySearchFabricType,\n      onSelectFabricType,\n      onTagClose,\n      onMainPhotoUpload,\n      onPhotosUpload,\n      onPhotoRemove,\n      onVideoUrlAdd,\n      onVideoUrlChange,\n      onCancel,\n      onSave,\n      onUpload,\n\n      getTagType,\n      getLastViewTimeString,\n      toNameUpperCase,\n      iconUploadUrl\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./FabricUpload.vue?vue&type=template&id=4b3f6934&scoped=true\"\nimport script from \"./FabricUpload.vue?vue&type=script&lang=ts\"\nexport * from \"./FabricUpload.vue?vue&type=script&lang=ts\"\n\nimport \"./FabricUpload.vue?vue&type=style&index=0&id=4b3f6934&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-4b3f6934\"\n\nexport default script","import { CascaderOptionItem } from \"@/typings/asideFilter\";\n\nexport function toNameUpperCase(name: string) {\n  const splitRules = [\" \", \"/\", \"+\", \"%\"];\n  const splitAry: string[] = name\n    .split(\"\")\n    .reduce((ary: string[], letter: string, index: number) => {\n      if (index === 0) {\n        ary.push(letter);\n        return ary;\n      }\n      if (splitRules.includes(letter)) {\n        ary.push(letter);\n      } else {\n        ary[ary.length - 1] = `${ary[ary.length - 1] + letter}`;\n      }\n      return ary;\n    }, []);\n\n  return splitAry\n    .map((it: string, index: number) => {\n      return it\n        .split(\"\")\n        .map((letter: string, _index: number) => {\n          return _index === (index === 0 ? 0 : 1)\n            ? letter.toUpperCase()\n            : letter.toLowerCase();\n        })\n        .join(\"\");\n    })\n    .join(\"\");\n}\n\nexport const removeEmptyChildren = (\n  result: CascaderOptionItem[],\n  it: CascaderOptionItem\n): CascaderOptionItem[] => {\n  if (it.children && it.children.length) {\n    result.push({\n      label: it.label,\n      value: it.value,\n      children: it.children.reduce(removeEmptyChildren, [])\n    });\n  } else {\n    result.push({\n      label: it.label,\n      value: it.value\n    });\n  }\n  return result;\n};\n\nexport const findTagTypeItem = (types: number[], options: CascaderOptionItem[]): CascaderOptionItem | undefined => {\n  const typeId = types[types.length - 1];\n  const flatten = (\n    result: CascaderOptionItem[],\n    it: CascaderOptionItem\n  ): CascaderOptionItem[] => {\n    if (it.children && it.children.length) {\n      result = [...result, it, ...it.children.reduce(flatten, [])];\n    } else {\n      result.push(it);\n    }\n    return result;\n  };\n  const flattenList = options.reduce(flatten, []);\n  return flattenList.find(\n    (it: CascaderOptionItem) => it.value === typeId\n  );\n};\n","module.exports = __webpack_public_path__ + \"img/upload.42ffdf67.png\";"],"sourceRoot":""}