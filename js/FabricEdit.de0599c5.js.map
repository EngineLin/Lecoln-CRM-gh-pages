{"version":3,"sources":["webpack:///./src/views/Fabric/FabricEdit.vue","webpack:///./src/views/Fabric/FabricEdit.vue?3d6b","webpack:///./src/views/Fabric/FabricEdit.vue?f850","webpack:///./src/apis/member.ts","webpack:///./src/utils/fabric.ts","webpack:///./src/assets/images/icons/png/upload.png","webpack:///./src/views/Fabric/FabricEdit.vue?c7c6"],"names":["id","class","onPhotosUpload","src","iconUploadUrl","alt","photosBase64","base64","index","key","content","name","placement","effect","icon","onPhotoRemove","form","video_urls","url","style","type","model-value","value","onVideoUrlChange","onVideoUrlAdd","sap_art_no","disabled","art_no","fetch-suggestions","onQuerySearch","toNameUpperCase","real_composition","onQuerySearchComposition","width","weight","status","statusOptions","item","label","exclusive_for","brandOptions","family_fabric_art_no","fabric_works_skus","tagType","placeholder","tagTypeOptions","fabricTypeValue","onQuerySearchFabricType","onSelectFabricType","tags","tag","closable","getTagType","tag_type","onTagClose","tag_name","onCancel","onSave","checked","Component","props","Number","default","setup","router","main_photo","photos","photos_with_id","storeMainPhoto","storePhotos","storePhotosWithId","fabricTypes","mainPhotoBase64","nameList","compositionList","reader","FileReader","onload","e","target","result","readAsDataURL","length","i","concat","file","data","map","it","init","detail","names","compositions","teams","media","createFilter","queryString","option","toLowerCase","indexOf","cb","results","filter","text","onMainPhotoUpload","element","document","createElement","accept","addEventListener","files","click","some","console","log","multiple","ary","back","loadingInstance","push","params","close","getLastViewTimeString","render","__scopeId","getMembers","category","q","method","getMember","getMemberRoles","getMemberTeams","getMemberBusinessUnits","postMember","email","nickname","role","phone","active","business_unit","postMemberPassword","postMemberAvatar","FormData","append","JSON","stringify","postContactUs","splitRules","splitAry","split","reduce","letter","includes","_index","toUpperCase","join","module","exports"],"mappings":"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","file":"js/FabricEdit.de0599c5.js","sourcesContent":["<template>\n  <div id=\"fabrics-upload-component\">\n    <div class=\"card\">\n      <div class=\"item\">\n        <p class=\"label\">Photos<span class=\"red-point\">*</span></p>\n        <div class=\"main-photo-container\">\n          <!--<div class=\"main-photo\" @click=\"onMainPhotoUpload\">-->\n          <!--<img-->\n          <!--class=\"photo\"-->\n          <!--v-if=\"mainPhotoBase64\"-->\n          <!--:src=\"mainPhotoBase64\"-->\n          <!--alt=\"\"-->\n          <!--/>-->\n          <!--<img class=\"icon\" v-else :src=\"iconUploadUrl\" alt=\"upload\" />-->\n          <!--</div>-->\n          <div class=\"note-container\">\n            <div class=\"note\">\n              <p>File Name: cloth number + _ + name</p>\n              <p>Photo within 1MB</p>\n              <p>1) Fabric picture: 10x10cm / 300dpi</p>\n              <p>2) Large image: 2000pixel / 300dpi</p>\n            </div>\n          </div>\n        </div>\n        <div class=\"photo-container\">\n          <div class=\"icon-upload\" @click=\"onPhotosUpload\">\n            <img :src=\"iconUploadUrl\" alt=\"upload\" />\n          </div>\n          <div class=\"photos\">\n            <div\n              v-for=\"(base64, index) in photosBase64\"\n              :key=\"index\"\n              class=\"photo\"\n            >\n              <el-tooltip :content=\"base64.name\" placement=\"top\" effect=\"light\">\n                <img :src=\"base64.src\" :alt=\"base64.name\" />\n              </el-tooltip>\n              <font-awesome-icon\n                class=\"icon\"\n                :icon=\"['far', 'times-circle']\"\n                @click=\"onPhotoRemove(index)\"\n              ></font-awesome-icon>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Video Url</p>\n        <el-input\n          v-for=\"(url, index) in form.video_urls\"\n          :key=\"index\"\n          class=\"value\"\n          :style=\"{ marginBottom: '8px' }\"\n          type=\"text\"\n          :model-value=\"url\"\n          @input=\"value => onVideoUrlChange(index, value)\"\n        ></el-input>\n\n        <div class=\"icon-add\" @click=\"onVideoUrlAdd\">\n          <font-awesome-icon\n            class=\"icon\"\n            :icon=\"['fas', 'plus-circle']\"\n          ></font-awesome-icon>\n        </div>\n      </div>\n      <div class=\"or-container\">\n        <div class=\"item\">\n          <p class=\"label\">New Art No in SAP (擇一)</p>\n          <el-input\n            class=\"value\"\n            type=\"text\"\n            v-model=\"form.sap_art_no\"\n            disabled\n          ></el-input>\n        </div>\n        <p class=\"or\">Or</p>\n        <div class=\"item\">\n          <p class=\"label\">Art No (擇一)</p>\n          <el-input\n            class=\"value\"\n            type=\"text\"\n            v-model=\"form.art_no\"\n            disabled\n          ></el-input>\n        </div>\n      </div>\n      <div class=\"line\"></div>\n      <div class=\"item\">\n        <p class=\"label\">Name<span class=\"red-point\">*</span></p>\n        <el-autocomplete\n          class=\"value\"\n          :model-value=\"form.name\"\n          :fetch-suggestions=\"onQuerySearch\"\n          @input=\"value => (form.name = toNameUpperCase(value))\"\n        ></el-autocomplete>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Real Composition<span class=\"red-point\">*</span></p>\n        <el-autocomplete\n          class=\"value\"\n          :model-value=\"form.real_composition\"\n          :fetch-suggestions=\"onQuerySearchComposition\"\n          @input=\"value => (form.real_composition = toNameUpperCase(value))\"\n        ></el-autocomplete>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Usable Width<span class=\"red-point\">*</span></p>\n        <div class=\"inch-item\">\n          <el-input class=\"value\" type=\"number\" v-model=\"form.width\"></el-input>\n          <p>Inch</p>\n        </div>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Weight in g/m²<span class=\"red-point\">*</span></p>\n        <el-input class=\"value\" type=\"number\" v-model=\"form.weight\"></el-input>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Status<span class=\"red-point\">*</span></p>\n        <el-select class=\"value\" v-model=\"form.status\">\n          <el-option\n            v-for=\"(item, index) in statusOptions\"\n            :key=\"index\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Limited Brand Name</p>\n        <el-select\n          :disabled=\"form.status !== 'exclusive'\"\n          class=\"value\"\n          v-model=\"form.exclusive_for\"\n        >\n          <el-option\n            v-for=\"(item, index) in brandOptions\"\n            :key=\"index\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">\n          Family Fabrics (art_no) (use \",\" to separate)\n        </p>\n        <el-input\n          class=\"value\"\n          type=\"text\"\n          v-model=\"form.family_fabric_art_no\"\n        ></el-input>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">\n          Fabric Works - SKU number (use \",\" to separate)\n        </p>\n        <el-input\n          class=\"value\"\n          type=\"text\"\n          v-model=\"form.fabric_works_skus\"\n        ></el-input>\n      </div>\n      <div class=\"line\"></div>\n      <div class=\"item\">\n        <p class=\"label\">Tags Selector</p>\n        <div class=\"tag-wrapper\">\n          <el-select v-model=\"tagType\" placeholder=\"Tag Type...\">\n            <el-option\n              v-for=\"item in tagTypeOptions\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            >\n            </el-option>\n          </el-select>\n        </div>\n        <el-autocomplete\n          class=\"input\"\n          v-model=\"fabricTypeValue\"\n          :fetch-suggestions=\"onQuerySearchFabricType\"\n          :disabled=\"!tagType\"\n          @keydown.enter=\"onSelectFabricType({ value: fabricTypeValue })\"\n          @select=\"onSelectFabricType\"\n        ></el-autocomplete>\n      </div>\n      <div class=\"item\">\n        <p class=\"label\">Tags</p>\n        <div class=\"tag-wrapper\">\n          <el-tag\n            v-for=\"(tag, index) in form.tags\"\n            :key=\"index\"\n            class=\"tag\"\n            closable\n            :type=\"getTagType(tag.tag_type)\"\n            @close=\"onTagClose(tag)\"\n          >\n            {{ tag.tag_name }}\n          </el-tag>\n        </div>\n      </div>\n\n      <div class=\"footer-container\">\n        <el-button type=\"info\" @click=\"onCancel\">Cancel</el-button>\n        <el-button type=\"success\" @click=\"onSave\">Update</el-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, toRefs, reactive, onMounted, watch } from \"vue\";\nimport { getLastViewTimeString, loading } from \"@/utils\";\nimport { useRouter } from \"vue-router\";\nimport iconUploadUrl from \"@/assets/images/icons/png/upload.png\";\nimport {\n  getFabric,\n  getFabricCompositionList,\n  getFabricNameList,\n  postUpdateFabric\n} from \"@/apis/fabric\";\nimport { OptionItem } from \"@/typings/asideFilter\";\nimport { getMemberTeams } from \"@/apis/member\";\nimport { getFabricTags } from \"@/apis/fabric\";\nimport { MemberTeam } from \"@/typings/member\";\nimport {\n  FabricFileResponse,\n  FabricTag,\n  FabricTagResponse,\n  FabricType,\n  PostUploadFabricParams\n} from \"@/typings/fabric\";\nimport { toNameUpperCase } from \"@/utils/fabric\";\n\nconst statusOptions: OptionItem[] = [\n  { label: \"Public\", value: \"public\", checked: false },\n  { label: \"Private\", value: \"private\", checked: false },\n  { label: \"Exclusive - Brand\", value: \"exclusive\", checked: false }\n];\nconst tagTypeOptions: OptionItem[] = [\n  { label: \"Sport\", value: \"sport\", checked: false },\n  { label: \"Style\", value: \"style\", checked: false },\n  { label: \"Clothes\", value: \"clothes\", checked: false },\n  { label: \"Category\", value: \"category\", checked: false }\n];\n\nconst getTagType = (type: string) => {\n  switch (type) {\n    case \"sport\":\n      return \"\";\n    case \"style\":\n      return \"success\";\n    case \"clothes\":\n      return \"info\";\n    case \"category\":\n      return \"warning\";\n    default:\n      return \"danger\";\n  }\n};\n\ninterface Base64 {\n  type: string;\n  name: string;\n  src: string;\n}\n\nconst Component = defineComponent({\n  name: \"FabricEdit\",\n  props: {\n    id: {\n      type: Number,\n      default: 0\n    }\n  },\n  setup(props) {\n    const router = useRouter();\n    const { id } = toRefs(props);\n    const form = reactive<PostUploadFabricParams>({\n      main_photo: null,\n      photos: [],\n      photos_with_id: [],\n      video_urls: [],\n      sap_art_no: \"\",\n      art_no: \"\",\n      name: \"\",\n      real_composition: \"\",\n      width: 0,\n      weight: 0,\n      status: \"public\",\n      exclusive_for: null,\n      family_fabric_art_no: \"\",\n      fabric_works_skus: \"\",\n      tags: []\n    });\n    const storeMainPhoto = ref<File | null>(null);\n    const storePhotos = ref<File[]>([]);\n    const storePhotosWithId = ref<FabricFileResponse[]>([]);\n    const tagType = ref<string | null>(null);\n    const fabricTypeValue = ref(\"\");\n    const fabricTypes = ref<string[]>([]);\n\n    const mainPhotoBase64 = ref(\"\");\n    const photosBase64 = ref<Base64[]>([]);\n    const nameList = ref<string[]>([]);\n    const compositionList = ref<string[]>([]);\n    const brandOptions = ref<OptionItem[]>([]);\n\n    watch([storeMainPhoto], () => {\n      if (!storeMainPhoto.value) return {};\n      const reader = new FileReader();\n      reader.onload = function(e: any) {\n        mainPhotoBase64.value = e.target.result;\n      };\n      reader.readAsDataURL(storeMainPhoto.value);\n      form.main_photo = storeMainPhoto.value;\n    });\n\n    watch([storePhotos], () => {\n      form.photos = storePhotos.value;\n      if (!storePhotos.value.length) return;\n      for (let i = 0; i < storePhotos.value.length; i++) {\n        const reader = new FileReader();\n        reader.onload = function(e: any) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo\",\n            name: storePhotos.value[i].name,\n            src: e.target.result\n          });\n        };\n        reader.readAsDataURL(storePhotos.value[i]);\n      }\n    });\n\n    watch([storePhotosWithId], () => {\n      form.photos_with_id = storePhotosWithId.value;\n      if (!storePhotosWithId.value.length) return;\n      for (let i = 0; i < storePhotosWithId.value.length; i++) {\n        photosBase64.value = photosBase64.value.concat({\n          type: \"photo_with_id\",\n          name: storePhotosWithId.value[i].name,\n          src: storePhotosWithId.value[i].file\n        });\n      }\n    });\n\n    watch([tagType], async () => {\n      if (tagType.value) {\n        const { data } = await getFabricTags(tagType.value);\n        fabricTypes.value = data.map((it: FabricType) => it.name);\n      }\n    });\n\n    const init = async () => {\n      const { data: detail } = await getFabric(id.value);\n      const { data: names } = await getFabricNameList();\n      const { data: compositions } = await getFabricCompositionList();\n      const { data: teams } = await getMemberTeams();\n      storePhotosWithId.value = detail.media;\n      form.video_urls = detail.video_urls;\n      form.sap_art_no = detail.sap_art_no;\n      form.art_no = detail.art_no;\n      form.name = detail.name;\n      form.real_composition = detail.real_composition;\n      form.width = detail.width;\n      form.weight = detail.weight;\n      form.status = detail.status;\n      form.exclusive_for = detail.exclusive_for;\n      form.family_fabric_art_no = detail.family_fabric_art_no;\n      form.fabric_works_skus = detail.fabric_works_skus;\n      form.tags = detail.tags.map((it: FabricTagResponse) => ({\n        tag_type: it.tag_type,\n        tag_name: it.name\n      }));\n      nameList.value = names.names.map((it: string[]) => it[0]);\n      compositionList.value = compositions.real_composition.map(\n        (it: string[]) => it[0]\n      );\n      brandOptions.value = teams.map((it: MemberTeam) => ({\n        label: it.name,\n        value: it.id,\n        checked: false\n      }));\n    };\n\n    onMounted(init);\n\n    const createFilter = (queryString: string) => {\n      return (option: string) => {\n        return option.toLowerCase().indexOf(queryString.toLowerCase()) > -1;\n      };\n    };\n\n    const onQuerySearch = async (queryString: string, cb: Function) => {\n      const results = queryString\n        ? nameList.value.filter(createFilter(queryString))\n        : nameList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchComposition = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? compositionList.value.filter(createFilter(queryString))\n        : compositionList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchFabricType = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? fabricTypes.value.filter(createFilter(queryString))\n        : fabricTypes.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onMainPhotoUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          storeMainPhoto.value = element.files[0];\n        }\n      });\n      element.click();\n    };\n\n    const onSelectFabricType = (data: { value: string }) => {\n      if (!fabricTypeValue.value) return;\n      if (\n        form.tags &&\n        form.tags.some(\n          (it: FabricTag) =>\n            it.tag_name === data.value && it.tag_type === tagType.value\n        )\n      ) {\n        fabricTypeValue.value = \"\";\n        return;\n      }\n      form.tags = [\n        ...form.tags!,\n        { tag_name: data.value, tag_type: tagType.value! }\n      ];\n      fabricTypeValue.value = \"\";\n    };\n\n    const onTagClose = (data: FabricTag) => {\n      console.log(data);\n      form.tags = form.tags.filter(\n        (it: FabricTag) =>\n          it.tag_name !== data.tag_name && it.tag_type !== data.tag_type\n      );\n    };\n\n    const onPhotosUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.multiple = true;\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          let ary: File[] = [];\n          for (let i = 0; i < element.files.length; i++) {\n            ary = [...ary, element.files[i]];\n          }\n          storePhotos.value = ary;\n        }\n      });\n      element.click();\n    };\n\n    const onPhotoRemove = (index: number) => {\n      const target: Base64 = photosBase64.value[index];\n      photosBase64.value = [];\n      if (target.type === \"photo\") {\n        storePhotos.value = storePhotos.value.filter(\n          (it: File) => it.name !== target.name\n        );\n        if (!storePhotosWithId.value.length) return;\n        for (let i = 0; i < storePhotosWithId.value.length; i++) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo_with_id\",\n            name: storePhotosWithId.value[i].name,\n            src: storePhotosWithId.value[i].file\n          });\n        }\n      }\n      if (target.type === \"photo_with_id\") {\n        storePhotosWithId.value = storePhotosWithId.value.filter(\n          (it: FabricFileResponse) => it.name !== target.name\n        );\n        if (!storePhotos.value.length) return;\n        for (let i = 0; i < storePhotos.value.length; i++) {\n          const reader = new FileReader();\n          reader.onload = function(e: any) {\n            photosBase64.value = photosBase64.value.concat({\n              type: \"photo\",\n              name: storePhotos.value[i].name,\n              src: e.target.result\n            });\n          };\n          reader.readAsDataURL(storePhotos.value[i]);\n        }\n      }\n    };\n\n    const onVideoUrlAdd = () => {\n      if (!form.video_urls) return;\n      form.video_urls = [...form.video_urls, \"\"];\n    };\n\n    const onVideoUrlChange = (index: number, value: string) => {\n      // @ts-ignore\n      form.video_urls[index] = value;\n    };\n\n    const onCancel = async () => {\n      await router.back();\n    };\n\n    const onSave = async () => {\n      const loadingInstance = loading();\n      try {\n        const { data } = await postUpdateFabric(id.value, form);\n        await router.push({ name: \"FabricDetail\", params: { id: data.id } });\n      } finally {\n        loadingInstance.close();\n      }\n    };\n\n    return {\n      form,\n      mainPhotoBase64,\n      photosBase64,\n      tagType,\n      fabricTypeValue,\n      statusOptions,\n      brandOptions,\n      tagTypeOptions,\n\n      onQuerySearch,\n      onQuerySearchComposition,\n      onQuerySearchFabricType,\n      onSelectFabricType,\n      onTagClose,\n      onMainPhotoUpload,\n      onPhotosUpload,\n      onPhotoRemove,\n      onVideoUrlAdd,\n      onVideoUrlChange,\n      onCancel,\n      onSave,\n\n      toNameUpperCase,\n      getTagType,\n      getLastViewTimeString,\n      iconUploadUrl\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#fabrics-upload-component\n  page-container()\n  .card\n    border-radius 15px\n    background white\n    padding 30px\n    flex-wrap wrap\n    flex(flex-start, flex-start)\n\n    .red-point\n      color red\n      margin 0 8px\n\n    .line\n      width 100%\n      height 2px\n      margin 15px 20px\n      background $color-secondary\n\n    .or-container\n      width 100%\n      flex()\n      .item\n        width calc(50% - 15px)\n      .or\n        padding-top 30px\n    .item\n      width calc(50% - 30px)\n      margin 0 15px 15px\n\n      :deep() .el-select\n        width 100%\n      :deep() .el-autocomplete\n        width calc(100% - 16px)\n        padding 0 8px\n\n      .label\n        padding 15px 8px 8px\n        font-size $font-size-large\n\n      .value\n        box-sizing border-box\n        width 100%\n        border-radius 4px\n        background white\n        padding 0 8px\n        font-size $font-size-lg2x\n        font-weight 400\n\n        &:focus\n          outline unset\n\n      .inch-item\n        flex()\n        margin 0 15px 0 0\n\n    .main-photo-container\n      flex(flex-start, flex-start)\n      .note-container\n        flex()\n        .note\n          font-size $font-size-normal\n          line-height 1.5\n    .photo-container\n      flex(flex-start)\n      margin 30px 0 0\n      .icon-upload\n        flex()\n        width 50px\n        height 50px\n        cursor pointer\n        margin 0 15px 0 0\n        img\n          width 30px\n          height 30px\n      .photos\n        flex(flex-start)\n        flex-wrap wrap\n        .photo\n          position relative\n          width 48px\n          height 48px\n          margin 0 8px 8px 0\n          border 1px solid black\n          background-repeat no-repeat\n          background-position center\n          background-size cover\n          img\n            width 100%\n            height 100%\n          .icon\n            position absolute\n            right -9px\n            top -9px\n            width 18px\n            height 18px\n            background white\n            cursor pointer\n    .icon-add\n      flex()\n      width 50px\n      height 50px\n      cursor pointer\n      .icon\n        width 30px\n        height 30px\n\n    .tag-wrapper\n      box-sizing border-box\n      padding 5px 8px\n      width 100%\n      font-size $font-size-lg2x\n      font-weight 400\n      border-radius 10px\n      background white\n\n      :deep() .el-autocomplete\n        width 100%\n      .tag\n        margin 0 8px 8px 0\n  .footer-container\n    width 100%\n    margin 30px 0 0\n    flex(flex-end)\n</style>\n","\nimport { defineComponent, ref, toRefs, reactive, onMounted, watch } from \"vue\";\nimport { getLastViewTimeString, loading } from \"@/utils\";\nimport { useRouter } from \"vue-router\";\nimport iconUploadUrl from \"@/assets/images/icons/png/upload.png\";\nimport {\n  getFabric,\n  getFabricCompositionList,\n  getFabricNameList,\n  postUpdateFabric\n} from \"@/apis/fabric\";\nimport { OptionItem } from \"@/typings/asideFilter\";\nimport { getMemberTeams } from \"@/apis/member\";\nimport { getFabricTags } from \"@/apis/fabric\";\nimport { MemberTeam } from \"@/typings/member\";\nimport {\n  FabricFileResponse,\n  FabricTag,\n  FabricTagResponse,\n  FabricType,\n  PostUploadFabricParams\n} from \"@/typings/fabric\";\nimport { toNameUpperCase } from \"@/utils/fabric\";\n\nconst statusOptions: OptionItem[] = [\n  { label: \"Public\", value: \"public\", checked: false },\n  { label: \"Private\", value: \"private\", checked: false },\n  { label: \"Exclusive - Brand\", value: \"exclusive\", checked: false }\n];\nconst tagTypeOptions: OptionItem[] = [\n  { label: \"Sport\", value: \"sport\", checked: false },\n  { label: \"Style\", value: \"style\", checked: false },\n  { label: \"Clothes\", value: \"clothes\", checked: false },\n  { label: \"Category\", value: \"category\", checked: false }\n];\n\nconst getTagType = (type: string) => {\n  switch (type) {\n    case \"sport\":\n      return \"\";\n    case \"style\":\n      return \"success\";\n    case \"clothes\":\n      return \"info\";\n    case \"category\":\n      return \"warning\";\n    default:\n      return \"danger\";\n  }\n};\n\ninterface Base64 {\n  type: string;\n  name: string;\n  src: string;\n}\n\nconst Component = defineComponent({\n  name: \"FabricEdit\",\n  props: {\n    id: {\n      type: Number,\n      default: 0\n    }\n  },\n  setup(props) {\n    const router = useRouter();\n    const { id } = toRefs(props);\n    const form = reactive<PostUploadFabricParams>({\n      main_photo: null,\n      photos: [],\n      photos_with_id: [],\n      video_urls: [],\n      sap_art_no: \"\",\n      art_no: \"\",\n      name: \"\",\n      real_composition: \"\",\n      width: 0,\n      weight: 0,\n      status: \"public\",\n      exclusive_for: null,\n      family_fabric_art_no: \"\",\n      fabric_works_skus: \"\",\n      tags: []\n    });\n    const storeMainPhoto = ref<File | null>(null);\n    const storePhotos = ref<File[]>([]);\n    const storePhotosWithId = ref<FabricFileResponse[]>([]);\n    const tagType = ref<string | null>(null);\n    const fabricTypeValue = ref(\"\");\n    const fabricTypes = ref<string[]>([]);\n\n    const mainPhotoBase64 = ref(\"\");\n    const photosBase64 = ref<Base64[]>([]);\n    const nameList = ref<string[]>([]);\n    const compositionList = ref<string[]>([]);\n    const brandOptions = ref<OptionItem[]>([]);\n\n    watch([storeMainPhoto], () => {\n      if (!storeMainPhoto.value) return {};\n      const reader = new FileReader();\n      reader.onload = function(e: any) {\n        mainPhotoBase64.value = e.target.result;\n      };\n      reader.readAsDataURL(storeMainPhoto.value);\n      form.main_photo = storeMainPhoto.value;\n    });\n\n    watch([storePhotos], () => {\n      form.photos = storePhotos.value;\n      if (!storePhotos.value.length) return;\n      for (let i = 0; i < storePhotos.value.length; i++) {\n        const reader = new FileReader();\n        reader.onload = function(e: any) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo\",\n            name: storePhotos.value[i].name,\n            src: e.target.result\n          });\n        };\n        reader.readAsDataURL(storePhotos.value[i]);\n      }\n    });\n\n    watch([storePhotosWithId], () => {\n      form.photos_with_id = storePhotosWithId.value;\n      if (!storePhotosWithId.value.length) return;\n      for (let i = 0; i < storePhotosWithId.value.length; i++) {\n        photosBase64.value = photosBase64.value.concat({\n          type: \"photo_with_id\",\n          name: storePhotosWithId.value[i].name,\n          src: storePhotosWithId.value[i].file\n        });\n      }\n    });\n\n    watch([tagType], async () => {\n      if (tagType.value) {\n        const { data } = await getFabricTags(tagType.value);\n        fabricTypes.value = data.map((it: FabricType) => it.name);\n      }\n    });\n\n    const init = async () => {\n      const { data: detail } = await getFabric(id.value);\n      const { data: names } = await getFabricNameList();\n      const { data: compositions } = await getFabricCompositionList();\n      const { data: teams } = await getMemberTeams();\n      storePhotosWithId.value = detail.media;\n      form.video_urls = detail.video_urls;\n      form.sap_art_no = detail.sap_art_no;\n      form.art_no = detail.art_no;\n      form.name = detail.name;\n      form.real_composition = detail.real_composition;\n      form.width = detail.width;\n      form.weight = detail.weight;\n      form.status = detail.status;\n      form.exclusive_for = detail.exclusive_for;\n      form.family_fabric_art_no = detail.family_fabric_art_no;\n      form.fabric_works_skus = detail.fabric_works_skus;\n      form.tags = detail.tags.map((it: FabricTagResponse) => ({\n        tag_type: it.tag_type,\n        tag_name: it.name\n      }));\n      nameList.value = names.names.map((it: string[]) => it[0]);\n      compositionList.value = compositions.real_composition.map(\n        (it: string[]) => it[0]\n      );\n      brandOptions.value = teams.map((it: MemberTeam) => ({\n        label: it.name,\n        value: it.id,\n        checked: false\n      }));\n    };\n\n    onMounted(init);\n\n    const createFilter = (queryString: string) => {\n      return (option: string) => {\n        return option.toLowerCase().indexOf(queryString.toLowerCase()) > -1;\n      };\n    };\n\n    const onQuerySearch = async (queryString: string, cb: Function) => {\n      const results = queryString\n        ? nameList.value.filter(createFilter(queryString))\n        : nameList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchComposition = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? compositionList.value.filter(createFilter(queryString))\n        : compositionList.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onQuerySearchFabricType = async (\n      queryString: string,\n      cb: Function\n    ) => {\n      const results = queryString\n        ? fabricTypes.value.filter(createFilter(queryString))\n        : fabricTypes.value;\n      cb(results.map((text: string) => ({ value: text })));\n    };\n\n    const onMainPhotoUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          storeMainPhoto.value = element.files[0];\n        }\n      });\n      element.click();\n    };\n\n    const onSelectFabricType = (data: { value: string }) => {\n      if (!fabricTypeValue.value) return;\n      if (\n        form.tags &&\n        form.tags.some(\n          (it: FabricTag) =>\n            it.tag_name === data.value && it.tag_type === tagType.value\n        )\n      ) {\n        fabricTypeValue.value = \"\";\n        return;\n      }\n      form.tags = [\n        ...form.tags!,\n        { tag_name: data.value, tag_type: tagType.value! }\n      ];\n      fabricTypeValue.value = \"\";\n    };\n\n    const onTagClose = (data: FabricTag) => {\n      console.log(data);\n      form.tags = form.tags.filter(\n        (it: FabricTag) =>\n          it.tag_name !== data.tag_name && it.tag_type !== data.tag_type\n      );\n    };\n\n    const onPhotosUpload = () => {\n      const element = document.createElement(\"input\");\n      element.type = \"file\";\n      element.accept = \"image/*\";\n      element.multiple = true;\n      element.addEventListener(\"change\", async () => {\n        if (element.files) {\n          let ary: File[] = [];\n          for (let i = 0; i < element.files.length; i++) {\n            ary = [...ary, element.files[i]];\n          }\n          storePhotos.value = ary;\n        }\n      });\n      element.click();\n    };\n\n    const onPhotoRemove = (index: number) => {\n      const target: Base64 = photosBase64.value[index];\n      photosBase64.value = [];\n      if (target.type === \"photo\") {\n        storePhotos.value = storePhotos.value.filter(\n          (it: File) => it.name !== target.name\n        );\n        if (!storePhotosWithId.value.length) return;\n        for (let i = 0; i < storePhotosWithId.value.length; i++) {\n          photosBase64.value = photosBase64.value.concat({\n            type: \"photo_with_id\",\n            name: storePhotosWithId.value[i].name,\n            src: storePhotosWithId.value[i].file\n          });\n        }\n      }\n      if (target.type === \"photo_with_id\") {\n        storePhotosWithId.value = storePhotosWithId.value.filter(\n          (it: FabricFileResponse) => it.name !== target.name\n        );\n        if (!storePhotos.value.length) return;\n        for (let i = 0; i < storePhotos.value.length; i++) {\n          const reader = new FileReader();\n          reader.onload = function(e: any) {\n            photosBase64.value = photosBase64.value.concat({\n              type: \"photo\",\n              name: storePhotos.value[i].name,\n              src: e.target.result\n            });\n          };\n          reader.readAsDataURL(storePhotos.value[i]);\n        }\n      }\n    };\n\n    const onVideoUrlAdd = () => {\n      if (!form.video_urls) return;\n      form.video_urls = [...form.video_urls, \"\"];\n    };\n\n    const onVideoUrlChange = (index: number, value: string) => {\n      // @ts-ignore\n      form.video_urls[index] = value;\n    };\n\n    const onCancel = async () => {\n      await router.back();\n    };\n\n    const onSave = async () => {\n      const loadingInstance = loading();\n      try {\n        const { data } = await postUpdateFabric(id.value, form);\n        await router.push({ name: \"FabricDetail\", params: { id: data.id } });\n      } finally {\n        loadingInstance.close();\n      }\n    };\n\n    return {\n      form,\n      mainPhotoBase64,\n      photosBase64,\n      tagType,\n      fabricTypeValue,\n      statusOptions,\n      brandOptions,\n      tagTypeOptions,\n\n      onQuerySearch,\n      onQuerySearchComposition,\n      onQuerySearchFabricType,\n      onSelectFabricType,\n      onTagClose,\n      onMainPhotoUpload,\n      onPhotosUpload,\n      onPhotoRemove,\n      onVideoUrlAdd,\n      onVideoUrlChange,\n      onCancel,\n      onSave,\n\n      toNameUpperCase,\n      getTagType,\n      getLastViewTimeString,\n      iconUploadUrl\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./FabricEdit.vue?vue&type=template&id=cb0606e8&scoped=true\"\nimport script from \"./FabricEdit.vue?vue&type=script&lang=ts\"\nexport * from \"./FabricEdit.vue?vue&type=script&lang=ts\"\n\nimport \"./FabricEdit.vue?vue&type=style&index=0&id=cb0606e8&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-cb0606e8\"\n\nexport default script","import request from \"@/apis/http\";\nimport { AxiosPromise } from \"axios\";\nimport { Member, MemberTeam, ContactUsParams, MemberRole } from \"@/typings/member\";\n\nexport function getMembers(\n  category?: string,\n  q?: string\n): AxiosPromise<Member[]> {\n  const params: { category?: string; q?: string } = {};\n\n  if (category) params.category = category;\n  if (q) params.q = q;\n  return request({\n    url: \"/members/\",\n    method: \"GET\",\n    params\n  });\n}\n\nexport function getMember(id?: number): AxiosPromise<Member> {\n  if (id) {\n    return request({\n      url: `/member/${id}/`,\n      method: \"GET\"\n    });\n  }\n  return request({\n    url: `/member/`,\n    method: \"GET\"\n  });\n}\n\nexport function getMemberRoles(id?: number, params?: { category?: string }): AxiosPromise<MemberRole[]> {\n  if (id) {\n    return request({\n      url: `/member/${id}/roles/`,\n      method: \"GET\",\n      params\n    });\n  }\n  return request({\n    url: `/member/roles/`,\n    method: \"GET\",\n    params\n  });\n}\n\n// Haven't id means get self teams data by token.\nexport function getMemberTeams(\n  id?: number,\n  params?: { category?: string }\n): AxiosPromise<MemberTeam[]> {\n  if (id) {\n    return request({\n      url: `/member/${id}/teams/`,\n      method: \"GET\",\n      params\n    });\n  }\n  return request({\n    url: \"/member/teams/\",\n    method: \"GET\",\n    params\n  });\n}\n\nexport function getMemberBusinessUnits(id?: number): AxiosPromise<string[]> {\n  if (id) {\n    return request({\n      url: `/member/${id}/business_units/`,\n      method: \"GET\"\n    });\n  }\n  return request({\n    url: \"/member/business_units/\",\n    method: \"GET\"\n  });\n}\n\nexport function postMember(params: Member, id?: number) {\n  const data = {\n    email: params.email,\n    nickname: params.nickname,\n    role: params.role,\n    teams: params.teams,\n    phone: params.phone,\n    active: params.active,\n    business_unit: params.business_unit\n  };\n  if (id) {\n    return request({\n      url: `/member/${id}/`,\n      method: \"PUT\",\n      data\n    });\n  }\n  return request({\n    url: `/member/`,\n    method: \"PUT\",\n    data\n  });\n}\n\nexport function postMemberPassword(data: { password: string }) {\n  return request({\n    url: `/member/`,\n    method: \"PUT\",\n    data\n  });\n}\n\nexport function postMemberAvatar(file: File, id?: number) {\n  const data = new FormData();\n  data.append(\"file\", file);\n  if (id) data.append(\"member\", JSON.stringify(id));\n\n  return request({\n    url: \"/member/medias/\",\n    method: \"POST\",\n    data\n  });\n}\n\nexport function postContactUs(data: ContactUsParams) {\n  return request({\n    url: `/mail/contact_us/`,\n    method: \"POST\",\n    data\n  });\n}\n","export function toNameUpperCase(name: string) {\n  const splitRules = [\" \", \"/\", \"+\", \"%\"];\n  const splitAry: string[] = name\n    .split(\"\")\n    .reduce((ary: string[], letter: string, index: number) => {\n      if (index === 0) {\n        ary.push(letter);\n        return ary;\n      }\n      if (splitRules.includes(letter)) {\n        ary.push(letter);\n      } else {\n        ary[ary.length - 1] = `${ary[ary.length - 1] + letter}`;\n      }\n      return ary;\n    }, []);\n\n  return splitAry\n    .map((it: string, index: number) => {\n      return it\n        .split(\"\")\n        .map((letter: string, _index: number) => {\n          return _index === (index === 0 ? 0 : 1)\n            ? letter.toUpperCase()\n            : letter.toLowerCase();\n        })\n        .join(\"\");\n    })\n    .join(\"\");\n}\n","module.exports = __webpack_public_path__ + \"img/upload.42ffdf67.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./FabricEdit.vue?vue&type=style&index=0&id=cb0606e8&scoped=true&lang=stylus\""],"sourceRoot":""}