{"version":3,"sources":["webpack:///./src/components/EDMTemplateCard.vue?2b25","webpack:///./src/views/EDM/EDM.vue","webpack:///./src/components/EDMTemplateCard.vue","webpack:///./src/components/EDMTemplateCard.vue?8e5e","webpack:///./src/components/EDMTemplateCard.vue?4302","webpack:///./src/views/EDM/EDM.vue?a41e","webpack:///./src/views/EDM/EDM.vue?b23c","webpack:///./src/constants/edm-cover.ts","webpack:///./src/views/EDM/EDM.vue?6195"],"names":["id","class","gutter","span","onCardClick","src","COVER_URL","COVER1","alt","COVER2","COVER3","list","sort","a","b","item","key","editable","onDuplicateClick","getCover","chosen_template","subject","visible","placement","offset","width","trigger","show-arrow","reference","icon","onDeleteClick","Component","name","props","type","Boolean","default","setup","_","emit","value","render","__scopeId","components","EDMTemplateCard","router","store","state","edm","init","loadingInstance","dispatch","close","_id","params","recipient_brand","message","message_body","html_message","creator","chosen_collection","Math","abs","data","title","push","templateId"],"mappings":"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","file":"js/EDM.28af3a0e.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EDMTemplateCard.vue?vue&type=style&index=0&id=0ab7b4c0&scoped=true&lang=stylus\"","<template>\n  <div id=\"edm-component\">\n    <h2 class=\"zoom-title\">Choose Template</h2>\n    <el-row :gutter=\"30\">\n      <el-col :span=\"8\">\n        <EDMTemplateCard @click=\"onCardClick(-1)\">\n          <img class=\"edm-cover-image\" :src=\"COVER_URL.COVER1\" alt=\"cover 1\" />\n        </EDMTemplateCard>\n        <p class=\"name\">Template 1</p>\n      </el-col>\n      <el-col :span=\"8\">\n        <EDMTemplateCard @click=\"onCardClick(-2)\">\n          <img class=\"edm-cover-image\" :src=\"COVER_URL.COVER2\" alt=\"cover 2\" />\n        </EDMTemplateCard>\n        <p class=\"name\">Template 2</p>\n      </el-col>\n      <el-col :span=\"8\">\n        <EDMTemplateCard @click=\"onCardClick(-3)\">\n          <img class=\"edm-cover-image\" :src=\"COVER_URL.COVER3\" alt=\"cover 3\" />\n        </EDMTemplateCard>\n        <p class=\"name\">Template 3</p>\n      </el-col>\n    </el-row>\n    <h2 class=\"zoom-title\">Saved EDM</h2>\n    <el-row :gutter=\"30\">\n      <el-col\n        v-for=\"item in list.sort((a, b) => b.id - a.id)\"\n        :key=\"item.id\"\n        :span=\"8\"\n      >\n        <EDMTemplateCard\n          editable\n          @click=\"onCardClick(item.id)\"\n          @duplicate=\"onDuplicateClick(item)\"\n        >\n          <img\n            class=\"edm-cover-image\"\n            :src=\"getCover(item.chosen_template)\"\n            alt=\"cover\"\n          />\n        </EDMTemplateCard>\n        <p class=\"name\">{{ item.subject }}</p>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, onMounted } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n\nimport EDMTemplateCard from \"@/components/EDMTemplateCard.vue\";\nimport { COVER_URL, getCover } from \"@/constants/edm-cover\";\nimport { GetEdms, PostCreateEdm, PostDuplicateEdm } from \"@/typings/store\";\nimport { EdmCardResponse, EdmParams } from \"@/typings/edm\";\nimport { ElNotification } from \"element-plus\";\nimport { loading } from \"@/utils\";\n\nconst Component = defineComponent({\n  name: \"EDM\",\n  components: {\n    EDMTemplateCard\n  },\n  setup: function() {\n    const router = useRouter();\n    const store = useStore();\n\n    const list = computed(() => store.state.edm.list);\n\n    const init = async () => {\n      const loadingInstance = loading();\n      await store.dispatch(GetEdms);\n      loadingInstance.close();\n    };\n\n    onMounted(async () => await init());\n\n    const onCardClick = async (id: number) => {\n      let _id = id;\n      if (_id < 0) {\n        const params: EdmParams = {\n          subject: `New EDM`,\n          recipient_brand: \"Brand Name\",\n          message: \"Message\",\n          message_body: \"Text\",\n          html_message: \"<div></div>\",\n          creator: 1, // TODO 確認之後是否還要帶\n          chosen_collection: null,\n          chosen_template: Math.abs(_id)\n        };\n        const data = await store.dispatch(PostCreateEdm, params);\n        _id = data.id;\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `Create new EDM successful.`\n        });\n      }\n      await router.push({ name: \"EDMDetail\", params: { id: _id } });\n    };\n\n    const onDuplicateClick = async (item: EdmCardResponse) => {\n      try {\n        await store.dispatch(PostDuplicateEdm, item.id);\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `EDM ${item.subject} duplicated successful.`\n        });\n        await init();\n      } catch (e) {\n        ElNotification({\n          title: \"Error\",\n          type: \"error\",\n          message: e\n        });\n      }\n    };\n\n    return {\n      COVER_URL,\n      list,\n\n      onCardClick,\n      onDuplicateClick,\n      getCover\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#edm-component\n  page-container()\n\n  .zoom-title\n    font-weight 500\n    margin 0 0 30px\n\n  .edm-cover-image\n    width 100%\n    height 100%\n\n  .name\n    text-align center\n    font-size $font-size-lg4x\n    font-weight 500\n    margin 15px 0\n\n  :deep() .el-col\n    margin-bottom 30px\n\n  :deep() .content-container\n    h1\n      font-size 10px\n      margin-bottom 6px\n    p\n      font-size 6px\n</style>\n","<template>\n  <div id=\"edm-template-card-component\">\n    <div class=\"wrapper\">\n      <slot></slot>\n\n      <el-popover\n        v-if=\"editable\"\n        v-model:visible=\"visible\"\n        placement=\"bottom\"\n        :offset=\"2\"\n        :width=\"80\"\n        trigger=\"click\"\n        :show-arrow=\"false\"\n      >\n        <div class=\"content\">\n          <p @click=\"onDuplicateClick\">Duplicate</p>\n          <p @click=\"onDeleteClick\">Delete</p>\n        </div>\n        <template #reference>\n          <div class=\"edit-icon\">\n            <font-awesome-icon\n              class=\"icon\"\n              :icon=\"['fas', 'ellipsis-h']\"\n            ></font-awesome-icon>\n          </div>\n        </template>\n      </el-popover>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref } from \"vue\";\n\nconst Component = defineComponent({\n  name: \"EDMTemplateCard\",\n  props: {\n    editable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(_, { emit }) {\n    const visible = ref(false);\n\n    const onDuplicateClick = () => {\n      visible.value = false;\n      emit(\"duplicate\");\n    };\n    const onDeleteClick = () => {\n      visible.value = false;\n      emit(\"delete\");\n    };\n\n    return {\n      visible,\n\n      onDuplicateClick,\n      onDeleteClick\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#edm-template-card-component\n  position relative\n  background-color white\n  border 1px solid $color-black\n  width 100%\n  padding-bottom 70%\n  cursor pointer\n\n  &:hover\n    border 1px solid $color-active\n    .wrapper\n      .edit-icon\n        display flex\n\n  .wrapper\n    position absolute\n    top 0\n    right 0\n    bottom 0\n    left 0\n\n    .edit-icon\n      flex()\n      display none\n      position absolute\n      bottom 10px\n      right 10px\n      width 35px\n      height 35px\n      background #4c4c4c\n      border-radius 5px\n      .icon\n        color white\n        width 25px\n        height 20px\n\n.content\n  padding 0 5px\n  p\n    padding 0\n    margin 10px 0\n    font-size 16px\n    font-weight 500\n    cursor pointer\n</style>\n","\nimport { defineComponent, ref } from \"vue\";\n\nconst Component = defineComponent({\n  name: \"EDMTemplateCard\",\n  props: {\n    editable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(_, { emit }) {\n    const visible = ref(false);\n\n    const onDuplicateClick = () => {\n      visible.value = false;\n      emit(\"duplicate\");\n    };\n    const onDeleteClick = () => {\n      visible.value = false;\n      emit(\"delete\");\n    };\n\n    return {\n      visible,\n\n      onDuplicateClick,\n      onDeleteClick\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./EDMTemplateCard.vue?vue&type=template&id=0ab7b4c0&scoped=true\"\nimport script from \"./EDMTemplateCard.vue?vue&type=script&lang=ts\"\nexport * from \"./EDMTemplateCard.vue?vue&type=script&lang=ts\"\n\nimport \"./EDMTemplateCard.vue?vue&type=style&index=0&id=0ab7b4c0&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-0ab7b4c0\"\n\nexport default script","\nimport { defineComponent, computed, onMounted } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n\nimport EDMTemplateCard from \"@/components/EDMTemplateCard.vue\";\nimport { COVER_URL, getCover } from \"@/constants/edm-cover\";\nimport { GetEdms, PostCreateEdm, PostDuplicateEdm } from \"@/typings/store\";\nimport { EdmCardResponse, EdmParams } from \"@/typings/edm\";\nimport { ElNotification } from \"element-plus\";\nimport { loading } from \"@/utils\";\n\nconst Component = defineComponent({\n  name: \"EDM\",\n  components: {\n    EDMTemplateCard\n  },\n  setup: function() {\n    const router = useRouter();\n    const store = useStore();\n\n    const list = computed(() => store.state.edm.list);\n\n    const init = async () => {\n      const loadingInstance = loading();\n      await store.dispatch(GetEdms);\n      loadingInstance.close();\n    };\n\n    onMounted(async () => await init());\n\n    const onCardClick = async (id: number) => {\n      let _id = id;\n      if (_id < 0) {\n        const params: EdmParams = {\n          subject: `New EDM`,\n          recipient_brand: \"Brand Name\",\n          message: \"Message\",\n          message_body: \"Text\",\n          html_message: \"<div></div>\",\n          creator: 1, // TODO 確認之後是否還要帶\n          chosen_collection: null,\n          chosen_template: Math.abs(_id)\n        };\n        const data = await store.dispatch(PostCreateEdm, params);\n        _id = data.id;\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `Create new EDM successful.`\n        });\n      }\n      await router.push({ name: \"EDMDetail\", params: { id: _id } });\n    };\n\n    const onDuplicateClick = async (item: EdmCardResponse) => {\n      try {\n        await store.dispatch(PostDuplicateEdm, item.id);\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `EDM ${item.subject} duplicated successful.`\n        });\n        await init();\n      } catch (e) {\n        ElNotification({\n          title: \"Error\",\n          type: \"error\",\n          message: e\n        });\n      }\n    };\n\n    return {\n      COVER_URL,\n      list,\n\n      onCardClick,\n      onDuplicateClick,\n      getCover\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./EDM.vue?vue&type=template&id=66406009&scoped=true\"\nimport script from \"./EDM.vue?vue&type=script&lang=ts\"\nexport * from \"./EDM.vue?vue&type=script&lang=ts\"\n\nimport \"./EDM.vue?vue&type=style&index=0&id=66406009&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-66406009\"\n\nexport default script","export const COVER_URL = {\n  COVER1: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_1.png\",\n  COVER2: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_2.png\",\n  COVER3: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_3.png\"\n};\n\nexport const getCover = (templateId: number) => {\n  if (templateId === 1) return COVER_URL.COVER1;\n  if (templateId === 2) return COVER_URL.COVER2;\n  if (templateId === 3) return COVER_URL.COVER3;\n  return COVER_URL.COVER1;\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EDM.vue?vue&type=style&index=0&id=66406009&scoped=true&lang=stylus\""],"sourceRoot":""}