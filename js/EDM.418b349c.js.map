{"version":3,"sources":["webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./src/views/EDM/EDM.vue","webpack:///./src/components/EDMTemplateCard.vue","webpack:///./src/components/EDMTemplateCard.vue?8e5e","webpack:///./src/components/EDMTemplateCard.vue?4302","webpack:///./src/views/EDM/EDM.vue?a41e","webpack:///./src/views/EDM/EDM.vue?b23c","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./src/components/EDMTemplateCard.vue?3a07","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./src/constants/edm-cover.ts","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./src/views/EDM/EDM.vue?bc84","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js"],"names":["userAgent","firefox","match","module","exports","id","class","gutter","span","onCardClick","src","COVER_URL","COVER1","alt","COVER2","COVER3","list","sort","a","b","item","key","editable","onDuplicateClick","getCover","chosen_template","subject","visible","placement","offset","width","trigger","show-arrow","reference","icon","onDeleteClick","Component","name","props","type","Boolean","default","setup","_","emit","value","render","__scopeId","components","EDMTemplateCard","router","store","state","edm","init","loadingInstance","dispatch","close","_id","params","recipient_brand","message","message_body","html_message","creator","chosen_collection","Math","abs","data","title","push","$","aFunction","toObject","toLength","fails","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","test","nativeSort","FAILS_ON_UNDEFINED","undefined","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","index","result","String","fromCharCode","k","v","length","charAt","FORCED","getSortCompare","comparefn","x","y","target","proto","forced","array","this","call","itemsLength","items","arrayLength","webkit","templateId","floor","mergeSort","middle","insertionSort","merge","slice","element","j","i","left","right","llength","rlength","lindex","rindex","UA"],"mappings":"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","file":"js/EDM.418b349c.js","sourcesContent":["var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","<template>\n  <div id=\"edm-component\">\n    <h2 class=\"zoom-title\">Choose Template</h2>\n    <el-row :gutter=\"30\">\n      <el-col :span=\"8\">\n        <EDMTemplateCard @click=\"onCardClick(-1)\">\n          <img class=\"edm-cover-image\" :src=\"COVER_URL.COVER1\" alt=\"cover 1\" />\n        </EDMTemplateCard>\n        <p class=\"name\">Template 1</p>\n      </el-col>\n      <el-col :span=\"8\">\n        <EDMTemplateCard @click=\"onCardClick(-2)\">\n          <img class=\"edm-cover-image\" :src=\"COVER_URL.COVER2\" alt=\"cover 2\" />\n        </EDMTemplateCard>\n        <p class=\"name\">Template 2</p>\n      </el-col>\n      <el-col :span=\"8\">\n        <EDMTemplateCard @click=\"onCardClick(-3)\">\n          <img class=\"edm-cover-image\" :src=\"COVER_URL.COVER3\" alt=\"cover 3\" />\n        </EDMTemplateCard>\n        <p class=\"name\">Template 3</p>\n      </el-col>\n    </el-row>\n    <h2 class=\"zoom-title\">Saved EDM</h2>\n    <el-row :gutter=\"30\">\n      <el-col\n        v-for=\"item in list.sort((a, b) => b.id - a.id)\"\n        :key=\"item.id\"\n        :span=\"8\"\n      >\n        <EDMTemplateCard\n          editable\n          @click=\"onCardClick(item.id)\"\n          @duplicate=\"onDuplicateClick(item)\"\n        >\n          <img\n            class=\"edm-cover-image\"\n            :src=\"getCover(item.chosen_template)\"\n            alt=\"cover\"\n          />\n        </EDMTemplateCard>\n        <p class=\"name\">{{ item.subject }}</p>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, onMounted } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n\nimport EDMTemplateCard from \"@/components/EDMTemplateCard.vue\";\nimport { COVER_URL, getCover } from \"@/constants/edm-cover\";\nimport { GetEdms, PostCreateEdm, PostDuplicateEdm } from \"@/typings/store\";\nimport { EdmCardResponse, EdmParams } from \"@/typings/edm\";\nimport { ElNotification } from \"element-plus\";\nimport { loading } from \"@/utils\";\n\nconst Component = defineComponent({\n  name: \"EDM\",\n  components: {\n    EDMTemplateCard\n  },\n  setup: function() {\n    const router = useRouter();\n    const store = useStore();\n\n    const list = computed(() => store.state.edm.list);\n\n    const init = async () => {\n      const loadingInstance = loading();\n      await store.dispatch(GetEdms);\n      loadingInstance.close();\n    };\n\n    onMounted(async () => await init());\n\n    const onCardClick = async (id: number) => {\n      let _id = id;\n      if (_id < 0) {\n        const params: EdmParams = {\n          subject: `New EDM`,\n          recipient_brand: \"Brand Name\",\n          message: \"Message\",\n          message_body: \"Text\",\n          html_message: \"<div></div>\",\n          creator: 1, // TODO 確認之後是否還要帶\n          chosen_collection: null,\n          chosen_template: Math.abs(_id)\n        };\n        const data = await store.dispatch(PostCreateEdm, params);\n        _id = data.id;\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `Create new EDM successful.`\n        });\n      }\n      await router.push({ name: \"EDMDetail\", params: { id: _id } });\n    };\n\n    const onDuplicateClick = async (item: EdmCardResponse) => {\n      try {\n        await store.dispatch(PostDuplicateEdm, item.id);\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `EDM ${item.subject} duplicated successful.`\n        });\n        await init();\n      } catch (e) {\n        ElNotification({\n          title: \"Error\",\n          type: \"error\",\n          message: e\n        });\n      }\n    };\n\n    return {\n      COVER_URL,\n      list,\n\n      onCardClick,\n      onDuplicateClick,\n      getCover\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#edm-component\n  page-container()\n\n  .zoom-title\n    font-weight 500\n    margin 0 0 30px\n\n  .edm-cover-image\n    width 100%\n    height 100%\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 12px 0 rgba(0, 0, 0, 0.19);\n\n  .name\n    text-align center\n    font-size $font-size-lg4x\n    font-weight 400\n    margin 15px 0\n\n  :deep() .el-col\n    margin-bottom 30px\n\n  :deep() .content-container\n    h1\n      font-size 10px\n      margin-bottom 6px\n    p\n      font-size 6px\n</style>\n","<template>\n  <div id=\"edm-template-card-component\">\n    <div class=\"wrapper\">\n      <slot></slot>\n\n      <el-popover\n        v-if=\"editable\"\n        v-model:visible=\"visible\"\n        placement=\"bottom\"\n        :offset=\"2\"\n        :width=\"80\"\n        trigger=\"click\"\n        :show-arrow=\"false\"\n      >\n        <div class=\"content\">\n          <p @click=\"onDuplicateClick\">Duplicate</p>\n          <p @click=\"onDeleteClick\">Delete</p>\n        </div>\n        <template #reference>\n          <div class=\"edit-icon\">\n            <font-awesome-icon\n              class=\"icon\"\n              :icon=\"['fas', 'ellipsis-h']\"\n            ></font-awesome-icon>\n          </div>\n        </template>\n      </el-popover>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref } from \"vue\";\n\nconst Component = defineComponent({\n  name: \"EDMTemplateCard\",\n  props: {\n    editable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(_, { emit }) {\n    const visible = ref(false);\n\n    const onDuplicateClick = () => {\n      visible.value = false;\n      emit(\"duplicate\");\n    };\n    const onDeleteClick = () => {\n      visible.value = false;\n      emit(\"delete\");\n    };\n\n    return {\n      visible,\n\n      onDuplicateClick,\n      onDeleteClick\n    };\n  }\n});\n\nexport default Component;\n</script>\n\n<style scoped lang=\"stylus\">\n#edm-template-card-component\n  position relative\n  background-color white\n  // border 1px solid $color-black\n  width 100%\n  padding-bottom 70%\n  cursor pointer\n\n  &:hover\n    // border 1px solid $color-active\n    box-shadow: 0 4px 6px 0 rgba(0, 0, 0, 0.2), 0 6px 18px 0 rgba(0, 0, 0, 0.19);\n    .wrapper\n      .edit-icon\n        display flex\n\n  .wrapper\n    position absolute\n    top 0\n    right 0\n    bottom 0\n    left 0\n\n    .edit-icon\n      flex()\n      display none\n      position absolute\n      bottom 10px\n      right 10px\n      width 35px\n      height 35px\n      background #4c4c4c\n      border-radius 5px\n      .icon\n        color white\n        width 25px\n        height 20px\n\n.content\n  padding 0 5px\n  p\n    padding 0\n    margin 10px 0\n    font-size 16px\n    font-weight 500\n    cursor pointer\n</style>\n","\nimport { defineComponent, ref } from \"vue\";\n\nconst Component = defineComponent({\n  name: \"EDMTemplateCard\",\n  props: {\n    editable: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(_, { emit }) {\n    const visible = ref(false);\n\n    const onDuplicateClick = () => {\n      visible.value = false;\n      emit(\"duplicate\");\n    };\n    const onDeleteClick = () => {\n      visible.value = false;\n      emit(\"delete\");\n    };\n\n    return {\n      visible,\n\n      onDuplicateClick,\n      onDeleteClick\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./EDMTemplateCard.vue?vue&type=template&id=713a3668&scoped=true\"\nimport script from \"./EDMTemplateCard.vue?vue&type=script&lang=ts\"\nexport * from \"./EDMTemplateCard.vue?vue&type=script&lang=ts\"\n\nimport \"./EDMTemplateCard.vue?vue&type=style&index=0&id=713a3668&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-713a3668\"\n\nexport default script","\nimport { defineComponent, computed, onMounted } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter } from \"vue-router\";\n\nimport EDMTemplateCard from \"@/components/EDMTemplateCard.vue\";\nimport { COVER_URL, getCover } from \"@/constants/edm-cover\";\nimport { GetEdms, PostCreateEdm, PostDuplicateEdm } from \"@/typings/store\";\nimport { EdmCardResponse, EdmParams } from \"@/typings/edm\";\nimport { ElNotification } from \"element-plus\";\nimport { loading } from \"@/utils\";\n\nconst Component = defineComponent({\n  name: \"EDM\",\n  components: {\n    EDMTemplateCard\n  },\n  setup: function() {\n    const router = useRouter();\n    const store = useStore();\n\n    const list = computed(() => store.state.edm.list);\n\n    const init = async () => {\n      const loadingInstance = loading();\n      await store.dispatch(GetEdms);\n      loadingInstance.close();\n    };\n\n    onMounted(async () => await init());\n\n    const onCardClick = async (id: number) => {\n      let _id = id;\n      if (_id < 0) {\n        const params: EdmParams = {\n          subject: `New EDM`,\n          recipient_brand: \"Brand Name\",\n          message: \"Message\",\n          message_body: \"Text\",\n          html_message: \"<div></div>\",\n          creator: 1, // TODO 確認之後是否還要帶\n          chosen_collection: null,\n          chosen_template: Math.abs(_id)\n        };\n        const data = await store.dispatch(PostCreateEdm, params);\n        _id = data.id;\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `Create new EDM successful.`\n        });\n      }\n      await router.push({ name: \"EDMDetail\", params: { id: _id } });\n    };\n\n    const onDuplicateClick = async (item: EdmCardResponse) => {\n      try {\n        await store.dispatch(PostDuplicateEdm, item.id);\n        ElNotification({\n          title: \"Success\",\n          type: \"success\",\n          message: `EDM ${item.subject} duplicated successful.`\n        });\n        await init();\n      } catch (e) {\n        ElNotification({\n          title: \"Error\",\n          type: \"error\",\n          message: e\n        });\n      }\n    };\n\n    return {\n      COVER_URL,\n      list,\n\n      onCardClick,\n      onDuplicateClick,\n      getCover\n    };\n  }\n});\n\nexport default Component;\n","import { render } from \"./EDM.vue?vue&type=template&id=b6a6758c&scoped=true\"\nimport script from \"./EDM.vue?vue&type=script&lang=ts\"\nexport * from \"./EDM.vue?vue&type=script&lang=ts\"\n\nimport \"./EDM.vue?vue&type=style&index=0&id=b6a6758c&scoped=true&lang=stylus\"\nscript.render = render\nscript.__scopeId = \"data-v-b6a6758c\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar nativeSort = test.sort;\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return String(x) > String(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aFunction(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort.call(array) : nativeSort.call(array, comparefn);\n\n    var items = [];\n    var arrayLength = toLength(array.length);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) items.push(array[index]);\n    }\n\n    items = internalSort(items, getSortCompare(comparefn));\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EDMTemplateCard.vue?vue&type=style&index=0&id=713a3668&scoped=true&lang=stylus\"","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","export const COVER_URL = {\n  COVER1: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_1.png\",\n  COVER2: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_2.png\",\n  COVER3: \"https://weaverbird.bilabasia.com/static/mail/covers/cover_3.png\"\n};\n\nexport const getCover = (templateId: number) => {\n  if (templateId === 1) return COVER_URL.COVER1;\n  if (templateId === 2) return COVER_URL.COVER2;\n  if (templateId === 3) return COVER_URL.COVER3;\n  return COVER_URL.COVER1;\n};\n","// TODO: use something more complex like timsort?\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    mergeSort(array.slice(0, middle), comparefn),\n    mergeSort(array.slice(middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n  var result = [];\n\n  while (lindex < llength || rindex < rlength) {\n    if (lindex < llength && rindex < rlength) {\n      result.push(comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]);\n    } else {\n      result.push(lindex < llength ? left[lindex++] : right[rindex++]);\n    }\n  } return result;\n};\n\nmodule.exports = mergeSort;\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EDM.vue?vue&type=style&index=0&id=b6a6758c&scoped=true&lang=stylus\"","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n"],"sourceRoot":""}